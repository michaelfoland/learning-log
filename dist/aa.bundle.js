!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=48)}([function(t,e,n){t.exports=n(41).default},function(t,e,n){"use strict";e.__esModule=!0,e.extend=s,e.indexOf=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}if(!i.test(t))return t;return t.replace(o,a)},e.isEmpty=function(t){return!t&&0!==t||!(!l(t)||0!==t.length)},e.createFrame=function(t){var e=s({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},o=/[&<>"'`=]/g,i=/[&<>"'`=]/;function a(t){return r[t]}function s(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}var u=Object.prototype.toString;e.toString=u;var c=function(t){return"function"==typeof t};c(/x/)&&(e.isFunction=c=function(t){return"function"==typeof t&&"[object Function]"===u.call(t)}),e.isFunction=c;var l=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===u.call(t)};e.isArray=l},function(t,e,n){"use strict";e.__esModule=!0;var r=["description","fileName","lineNumber","message","name","number","stack"];function o(t,e){var n=e&&e.loc,i=void 0,a=void 0;n&&(t+=" - "+(i=n.start.line)+":"+(a=n.start.column));for(var s=Error.prototype.constructor.call(this,t),u=0;u<r.length;u++)this[r[u]]=s[r[u]];Error.captureStackTrace&&Error.captureStackTrace(this,o);try{n&&(this.lineNumber=i,Object.defineProperty?Object.defineProperty(this,"column",{value:a,enumerable:!0}):this.column=a)}catch(t){}}o.prototype=new Error,e.default=o,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bundlePromises=function(t,e){var n=void 0,r=0;n=e?{}:new Array(t.length);return new Promise(function(o,i){t.forEach(function(t,i,a){t.then(function(t){Array.isArray(n)?n[i]=t:n[e[i]]=t,++r===a.length&&o(n)},function(t){Array.isArray(n)?n[i]=t:n[e[i]]=t,++r===a.length&&o(n)})})})}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({1:function(t,e,n,r,o){var i;return'  <h2 class="date-block-heading">'+t.escapeExpression(t.lambda(null!=e?e.date:e,e))+"</h2>\r\n"+(null!=(i=n.each.call(null!=e?e:t.nullContext||{},null!=e?e.entries:e,{name:"each",hash:{},fn:t.program(2,o,0),inverse:t.noop,data:o}))?i:"")},2:function(t,e,r,o,i){var a;return null!=(a=t.invokePartial(n(13),e,{name:"logEntry",data:i,indent:"    ",helpers:r,partials:o,decorators:t.decorators}))?a:""},compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){var i;return null!=(i=n.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o}))?i:""},usePartial:!0,useData:!0})},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({1:function(t,e,n,r,o){var i=t.lambda,a=t.escapeExpression;return'    <button data-target="'+a(i(e,e))+'" class="sub-button">'+a(i(e,e))+"</button>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){var i;return'\x3c!-- This <div> is what slides --\x3e\r\n<div class="sub-button-group__button-container">\r\n'+(null!=(i=n.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o}))?i:"")+'</div>\r\n\r\n<div class="sub-button-nav-button-container">\r\n  \x3c!-- replace these buttons with proper svg icons at some point --\x3e\r\n  <button type="button" role="button" class="previous-row-button sub-button-nav" data-nav-direction="backward" >\r\n    <svg width="20" height="12">\r\n      <polyline points="2 11, 10 4, 18 11" fill="transparent" stroke-width="3" />\r\n    </svg>\r\n  </button>\r\n  <span class="flex-spacer"></span>\r\n  <button type="button" role="button" class="next-row-button sub-button-nav" data-nav-direction="forward">\r\n    <svg width="20" height="12">\r\n      <polyline points="2 1, 10 8, 18 1" fill="transparent" stroke-width="3" />\r\n    </svg>\r\n  </button>\r\n</div>'},useData:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.insertSpacers=function(t){var e=void 0;Array.from(document.querySelectorAll(t)).forEach(function(t){(e=document.createElement("div")).setAttribute("data-spacer-target",t.id),e.classList.add("fixed-position-spacer"),e.style.height=t.getBoundingClientRect().height+"px",t.insertAdjacentElement("afterend",e)}),window.addEventListener("resize",function(t){r&&window.cancelAnimationFrame(r),r=window.requestAnimationFrame(function(){var t=Array.from(document.getElementsByClassName("fixed-position-spacer"));t.forEach(function(t){t.style.height=document.getElementById(t.dataset.spacerTarget).getBoundingClientRect().height+"px"})})})};var r=null},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.HandlebarsEnvironment=c;var o=n(1),i=r(n(2)),a=n(40),s=n(32),u=r(n(30));e.VERSION="4.0.11";e.COMPILER_REVISION=7;e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};function c(t,e,n){this.helpers=t||{},this.partials=e||{},this.decorators=n||{},a.registerDefaultHelpers(this),s.registerDefaultDecorators(this)}c.prototype={constructor:c,logger:u.default,log:u.default.log,registerHelper:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new i.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if("[object Object]"===o.toString.call(t))o.extend(this.partials,t);else{if(void 0===e)throw new i.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new i.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var l=u.default.log;e.log=l,e.createFrame=o.createFrame,e.logger=u.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isReady=function t(e){null==e&&(e=0);return new Promise(function(n,r){u?n(!0):e===c?r("db didn't load after "+c+" checks"):setTimeout(function(){t(e+1).then(function(t){return n(!0)},function(t){return r(t)})},l)})},e.getSettings=function(){return new Promise(function(t,e){s.findOne({},function(n,r){n&&e("error querying settings"),t(r)})})},e.updateSettings=function(t){return new Promise(function(e,n){s.update({},t,{multi:!1,upsert:!0},function(t,r,o,i){t?n("db error: unable to update settings"):e(o)})})},e.getAll=function(t){var e={};e[t]={$exists:!0};var n={};return n[t]=1,new Promise(function(r,o){a.find(e,n,function(e,n){e&&o("error in finding the property '"+t+"'in learningLog");var i={};n.forEach(function(e){i.hasOwnProperty(e[t])?i[e[t]]++:i[e[t]]=1});var a=[];for(var s in i)a.push({prop:s,count:i[s]});a.sort(function(t,e){return e.count-t.count}),r(a.map(function(t){return t.prop}))})})},e.logDbContents=function(){a.find({},function(t,e){t&&console.log("can't log db contents for some reason"),console.log("==============="),e.forEach(function(t,e){for(var n in console.log("doc ",e+1,":"),t)t.hasOwnProperty(n)&&console.log("\t"+n+":\t"+t[n])})})},e.getBySearchString=function(t){var e=t.split(" "),n=[];return(e=e.filter(function(t){return""!==t.trim()}).map(function(t){return"\\b"+t+"\\b"})).forEach(function(t){n.push({title:RegExp(t,"i")}),n.push({details:RegExp(t,"i")})}),new Promise(function(t,e){d({$or:n}).then(function(e){return t(e)},function(t){return e(t)})})},e.getByFrequency=function(t){var e={};e[t]={$exists:!0};var n={};return n[t]=1,new Promise(function(r,o){a.find(e,n,function(e,n){e&&o("error in finding the property '"+t+"'in learningLog");var i={};n.forEach(function(e){i.hasOwnProperty(e[t])?i[e[t]]++:i[e[t]]=1});var a=[];for(var s in i)a.push([s,i[s]]);a=a.sort(function(t,e){return t[1]<e[1]}).map(function(t){return t[0]}),r(a)})})},e.getAllEntries=function(){return new Promise(function(t,e){d({}).then(function(e){return t(e)},function(t){return e(t)})})},e.getEntries=d,e.add=function(t){return console.log("=== database add()"),new Promise(function(e,n){a.insert(t,function(t,r){t?n({message:"error inserting doc",doc:r}):e({message:"successfully inserted doc",doc:r})})})};var r,o=n(47),i=(r=o)&&r.__esModule?r:{default:r};var a=new i.default({filename:"learningLog",autoload:!0,onload:f,timestampData:!0}),s=new i.default({filename:"settings",autoload:!0,onload:f}),u=!1,c=3,l=1e3;function f(t){s&&a&&(u=!0),t&&console.log(t)}function d(t){return console.log("=== database getEntries()"),new Promise(function(e,n){a.find(t).sort({date:-1,createdAt:-1}).exec(function(r,o){r?n({message:"error executing query",query:t}):e({message:"successfully executed query",query:t,docs:o})})})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.defaultSettings={sourceLengthMin:20,sourceLengthDefault:50,sourceLengthUser:50,sourceLengthMax:100,subjectLengthMin:20,subjectLengthDefault:50,subjectLengthUser:50,subjectLengthMax:100,titleLengthMin:50,titleLengthDefault:100,titleLengthUser:100,titleLengthMax:200,sourcePromptsMin:0,sourcePromptsDefault:10,sourcePromptsUser:10,sourcePromptsMax:50,subjectPromptsMin:0,subjectPromptsDefault:10,subjectPromptsUser:10,subjectPromptsMax:50,entriesPerPageMin:5,entriesPerPageDefault:20,entriesPerPageUser:20,entriesPerPageMax:50,color0:200,color1:40,color2:120}},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){var i,a=null!=e?e:t.nullContext||{},s=n.helperMissing,u="function",c=t.escapeExpression;return'<div id="settings-panel" class="top-level-view">\r\n  <div class="setting-row" id="settings-color">\r\n    <div class="setting-title">Theme Colors</div>\r\n    <div class="setting-content">\r\n      <div class="theme-color-group">\r\n        <label for="color-1-input">Color 1</label>\r\n        \r\n        <input class="theme-color-input" type="range" min="0" value="'+c(typeof(i=null!=(i=n.color0||(null!=e?e.color0:e))?i:s)===u?i.call(a,{name:"color0",hash:{},data:o}):i)+'" max="359" step="1" id="color-1-input" data-target="swatch-1" data-prop-name="color0">\r\n        \r\n        <div class="color-pair">\r\n          <span class="theme-color-swatch" id="swatch-1-light"></span>\r\n          <span class="theme-color-swatch" id="swatch-1-dark"></span>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class="theme-color-group">\r\n        <label for="color-2-input">Color 2</label>\r\n          \r\n        <input class="theme-color-input" type="range" min="0" value="'+c(typeof(i=null!=(i=n.color1||(null!=e?e.color1:e))?i:s)===u?i.call(a,{name:"color1",hash:{},data:o}):i)+'" max="359" step="1" id="color-2-input" data-target="swatch-2" data-prop-name="color1">\r\n\r\n        <div class="color-pair">\r\n          <span class="theme-color-swatch" id="swatch-2-light"></span>\r\n          <span class="theme-color-swatch" id="swatch-2-dark"></span>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class="theme-color-group">\r\n        <label for="color-3-input">Color 3</label>\r\n          \r\n        <input class="theme-color-input" type="range" min="0" value="'+c(typeof(i=null!=(i=n.color2||(null!=e?e.color2:e))?i:s)===u?i.call(a,{name:"color2",hash:{},data:o}):i)+'" max="359" step="1" id="color-3-input" data-target="swatch-3" data-prop-name="color2">\r\n\r\n        <div class="color-pair">\r\n          <span class="theme-color-swatch" id="swatch-3-light"></span>\r\n          <span class="theme-color-swatch" id="swatch-3-dark"></span>\r\n        </div>\r\n      </div>      \r\n    </div>\r\n  </div>\r\n\r\n  <div class="setting-row" id="settings-entries">\r\n    <div class="setting-title">Number of entries to display in log view</div>\r\n    <div class="setting-content">\r\n      <div class="setting-content__sub-row">\r\n        <label for="entries-per-page">Entries</label>\r\n        <input type="number" id="entries-per-page" class="setting-content__sub-row-input" min="'+c(typeof(i=null!=(i=n.entriesPerPageMin||(null!=e?e.entriesPerPageMin:e))?i:s)===u?i.call(a,{name:"entriesPerPageMin",hash:{},data:o}):i)+'" max="'+c(typeof(i=null!=(i=n.entriesPerPageMax||(null!=e?e.entriesPerPageMax:e))?i:s)===u?i.call(a,{name:"entriesPerPageMax",hash:{},data:o}):i)+'" step="5" placeholder="'+c(typeof(i=null!=(i=n.entriesPerPageUser||(null!=e?e.entriesPerPageUser:e))?i:s)===u?i.call(a,{name:"entriesPerPageUser",hash:{},data:o}):i)+'" data-prop-name="entriesPerPageUser">\r\n        <span class="instruction"><span class="text-chunk">bewteen 5 and 50, </span><span class="text-chunk">multiples of 5</span></span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="setting-row" id="settings-length">\r\n    <div class="setting-title">Maximum length of log entry fields (in characters)</div>\r\n    <div class="setting-content">\r\n      <div class="setting-content__sub-row">\r\n        <label for="source-length-input">Source</label>\r\n        <input type="number" class="setting-content__sub-row-input" placeholder="'+c(typeof(i=null!=(i=n.sourceLengthUser||(null!=e?e.sourceLengthUser:e))?i:s)===u?i.call(a,{name:"sourceLengthUser",hash:{},data:o}):i)+'" min="'+c(typeof(i=null!=(i=n.sourceLengthMin||(null!=e?e.sourceLengthMin:e))?i:s)===u?i.call(a,{name:"sourceLengthMin",hash:{},data:o}):i)+'" max="'+c(typeof(i=null!=(i=n.sourceLengthMax||(null!=e?e.sourceLengthMax:e))?i:s)===u?i.call(a,{name:"sourceLengthMax",hash:{},data:o}):i)+'" data-prop-name="sourceLengthUser">\r\n        <span class="instruction">between 20 and 100</span>\r\n      </div>\r\n      <div class="setting-content__sub-row">\r\n        <label for="subject-length-input">Subject</label>\r\n        <input type="number" id="subject-length-input" class="setting-content__sub-row-input" placeholder="'+c(typeof(i=null!=(i=n.subjectLengthUser||(null!=e?e.subjectLengthUser:e))?i:s)===u?i.call(a,{name:"subjectLengthUser",hash:{},data:o}):i)+'" min="'+c(typeof(i=null!=(i=n.subjectLengthMin||(null!=e?e.subjectLengthMin:e))?i:s)===u?i.call(a,{name:"subjectLengthMin",hash:{},data:o}):i)+'" max="'+c(typeof(i=null!=(i=n.subjectLengthMax||(null!=e?e.subjectLengthMax:e))?i:s)===u?i.call(a,{name:"subjectLengthMax",hash:{},data:o}):i)+'" data-prop-name="subjectLengthUser">\r\n        <span class="instruction">between 20 and 100</span>\r\n      </div>\r\n      <div class="setting-content__sub-row">\r\n        <label for="title-length-input">Title</label>\r\n        <input type="number" id="title-length-input" class="setting-content__sub-row-input" placeholder="'+c(typeof(i=null!=(i=n.titleLengthUser||(null!=e?e.titleLengthUser:e))?i:s)===u?i.call(a,{name:"titleLengthUser",hash:{},data:o}):i)+'" min="'+c(typeof(i=null!=(i=n.titleLengthMin||(null!=e?e.titleLengthMin:e))?i:s)===u?i.call(a,{name:"titleLengthMin",hash:{},data:o}):i)+'" max="'+c(typeof(i=null!=(i=n.titleLengthMax||(null!=e?e.titleLengthMax:e))?i:s)===u?i.call(a,{name:"titleLengthMax",hash:{},data:o}):i)+'" data-prop-name="titleLengthUser">\r\n        <span class="instruction">between 50 and 200</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="setting-row" id="settings-prompts">\r\n    <div class="setting-title">Maximum number of prompt buttons to display on entry form</div>\r\n    <div class="setting-content">\r\n      <div class="setting-content__sub-row">\r\n        <label for="source-prompt-input">Source</label>\r\n        <input type="number" id="source-prompt-input" class="setting-content__sub-row-input" placeholder="'+c(typeof(i=null!=(i=n.sourcePromptsUser||(null!=e?e.sourcePromptsUser:e))?i:s)===u?i.call(a,{name:"sourcePromptsUser",hash:{},data:o}):i)+'" min="'+c(typeof(i=null!=(i=n.sourcePromptsMin||(null!=e?e.sourcePromptsMin:e))?i:s)===u?i.call(a,{name:"sourcePromptsMin",hash:{},data:o}):i)+'" max="'+c(typeof(i=null!=(i=n.sourcePromptsMax||(null!=e?e.sourcePromptsMax:e))?i:s)===u?i.call(a,{name:"sourcePromptsMax",hash:{},data:o}):i)+'" data-prop-name="sourcePromptsUser">\r\n        \r\n        <span class="instruction">between 0 and 50</span>\r\n      </div>\r\n      <div class="setting-content__sub-row">\r\n        <label for="subject-prompt-input">Subject</label>\r\n          \r\n        <input type="number" id="subject-prompt-input" class="setting-content__sub-row-input" placeholder="'+c(typeof(i=null!=(i=n.subjectPromptsUser||(null!=e?e.subjectPromptsUser:e))?i:s)===u?i.call(a,{name:"subjectPromptsUser",hash:{},data:o}):i)+'" min="'+c(typeof(i=null!=(i=n.subjectPromptsMin||(null!=e?e.subjectPromptsMin:e))?i:s)===u?i.call(a,{name:"subjectPromptsMin",hash:{},data:o}):i)+'" max="'+c(typeof(i=null!=(i=n.subjectPromptsMax||(null!=e?e.subjectPromptsMax:e))?i:s)===u?i.call(a,{name:"subjectPromptsMax",hash:{},data:o}):i)+'" data-prop-name="subjectPromptsUser">\r\n        \r\n        <span class="instruction">between 0 and 50</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  \r\n  <div class="setting-row" id="settings-button-row">\r\n    <button type="button" role="button" class="settings-panel-button" id="settings-panel__reset-button">Reset</button>\r\n    <button type="button" role="button" class="settings-panel-button" id="settings-panel__save-button">Save Settings</button>\r\n  </div>\r\n\r\n</div>'},useData:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buttonText=e.id=void 0,e.render=function(){return a.getSettings().then(function(t){return c=t,(0,i.default)(t)},function(t){console.log("error in call to db.getSettings() from render() in settingsPanel.js")})},e.postRender=function(){u=document.getElementById(s),console.log("executing settingsPanel postRender()"),u.addEventListener("input",h,!1),u.addEventListener("click",d,!1),f()},e.preDestroy=function(){console.log("in settingsPanel.destroy()"),y()};var r,o=n(11),i=(r=o)&&r.__esModule?r:{default:r},a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(9));var s=e.id="settings-panel",u=(e.buttonText="Settings",void 0),c=void 0;function l(t,e){document.getElementById(t+"-dark").style.background=g(e),document.getElementById(t+"-light").style.background=v(e)}function f(){for(var t=u.getElementsByClassName("theme-color-input"),e=0;e<t.length;e++)l(t[e].dataset.target,t[e].value)}function d(t){var e=t.target;e.matches(".settings-panel-button")&&("settings-panel__reset-button"===e.id?(u.querySelector("#color-1-input").value=c.color0,u.querySelector("#color-2-input").value=c.color1,u.querySelector("#color-3-input").value=c.color2,f(),p(1,document.getElementById("color-1-input").value),p(2,document.getElementById("color-2-input").value),p(3,document.getElementById("color-3-input").value),Array.from(u.querySelectorAll("input:not(.theme-color-input)")).forEach(function(t){return t.value=""}),window.scrollTo({top:0,behavior:"smooth"})):"settings-panel__save-button"===e.id&&y())}function h(t){if(t.target.matches(".theme-color-input")){var e=t.target.value,n=t.target.dataset.target;l(n,e),p(n.charAt(n.length-1),e)}}function p(t,e){document.documentElement.style.setProperty("--color-"+t,v(e)),document.documentElement.style.setProperty("--color-"+t+"-dark",g(e))}function g(t){return"hsl("+t+", 65%, 35%)"}function v(t){return"hsl("+t+", 50%, 50%)"}function y(){Array.from(u.querySelectorAll("[data-prop-name]")).forEach(function(t){t.value&&t.value!==c[t.dataset.propName]&&(!0,c[t.dataset.propName]=t.value)}),a.updateSettings(c).then(function(t){document.getElementById("main-container").innerHTML=(0,i.default)(c),window.scrollTo({top:0,behavior:"smooth"})},function(t){console.log("error while trying to update settings")})}},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){var i,a=null!=e?e:t.nullContext||{},s=n.helperMissing,u=t.escapeExpression;return'<div class="log-entry">\r\n  <div class="log-entry__title-row">\r\n    <span class="log-entry__title">'+u("function"==typeof(i=null!=(i=n.title||(null!=e?e.title:e))?i:s)?i.call(a,{name:"title",hash:{},data:o}):i)+'</span>\r\n    <div class="log-entry__metadata">\r\n      <span class="log-entry__subject">'+u("function"==typeof(i=null!=(i=n.subject||(null!=e?e.subject:e))?i:s)?i.call(a,{name:"subject",hash:{},data:o}):i)+'</span>\r\n      <span class="log-entry__source">'+u("function"==typeof(i=null!=(i=n.source||(null!=e?e.source:e))?i:s)?i.call(a,{name:"source",hash:{},data:o}):i)+'</span>\r\n    </div>\r\n    \r\n  </div>\r\n  <div class="log-entry__other">\r\n    <p class="log-entry__details">'+u("function"==typeof(i=null!=(i=n.details||(null!=e?e.details:e))?i:s)?i.call(a,{name:"details",hash:{},data:o}):i)+"</p>\r\n  </div>\r\n</div>"},useData:!0})},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({compiler:[7,">= 4.0.0"],main:function(t,e,r,o,i){var a;return'<div id="log-view" class="top-level-view">\r\n  <div id="log-view-filter">\r\n    <div id="log-view-filter__button-group">\r\n      <button type="button" role="button" class="log-view__button" data-target="date" id="log-view__date-button">Date</button>\r\n      <button type="button" role="button" class="log-view__button" data-target="subject" id="log-view__subject-button">Subject</button>\r\n      <button type="button" role="button" class="log-view__button" data-target="source" id="log-view__source-button">Source</button>\r\n      <button type="button" role="button" class="log-view__button" data-target="search" id="log-view__search-button">Search</button>\r\n    </div>\r\n    \r\n    <div id="log-view-filter__search-lg" >\r\n      <input type="text" class="log-view-filter__search-input" id="search-input-lg">\r\n      <button type="button" role="button" id="log-view__search-submit-button" data-search-input="search-input-lg">Search</button>\r\n    </div>\r\n    \r\n    <div id="log-view-filter__sub-button-group">\r\n      <div id="log-view-filter__date-sub-buttons" data-query-type="date" class="sub-button-group">\r\n        <div id="log-view-filter__date-keyword-buttons">\r\n          <button type="button" role="button" class="sub-button" data-target="this-week"><span>This week</span></button>\r\n          <button type="button" role="button" class="sub-button" data-target="last-week">Last week</button>\r\n          <button type="button" role="button" class="sub-button" data-target="this-month">This month</button>\r\n          <button type="button" role="button" class="sub-button" data-target="last-month">Last month</button>\r\n        </div>\r\n        <div id="custom-date-search">\r\n          <input type="date" id="start-date-input" class="date-filter-input"><span> to </span><input type="date" id="end-date-input" class="date-filter-input">\r\n          <button type="button" role="button" class="sub-button" id="custom-date-filter-button">Filter</button>\r\n        </div>\r\n      </div>\r\n      \r\n      <div id="log-view-filter__subject-sub-buttons" data-query-type="subject" class="sub-button-group fixed-container">'+(null!=(a=t.invokePartial(n(6),null!=e?e.subjects:e,{name:"subButtons",data:i,helpers:r,partials:o,decorators:t.decorators}))?a:"")+'</div>\r\n\r\n      <div id="log-view-filter__source-sub-buttons" data-query-type="source" class="sub-button-group fixed-container">'+(null!=(a=t.invokePartial(n(6),null!=e?e.sources:e,{name:"subButtons",data:i,helpers:r,partials:o,decorators:t.decorators}))?a:"")+'</div>\r\n      \r\n      <div id="log-view-filter__search-sub-buttons" class="sub-button-group">\r\n        <input type="text" class="log-view-filter__search-input" id="search-input-sm">\r\n        <button type="button" role="button" class="sub-button" id="log-view-filter__search-submit-button" data-search-input="search-input-sm">Search</button>\r\n      </div>      \r\n    </div>\r\n    \r\n    \r\n    <div id="log-view-filter__message">\r\n      <span id="log-view-filter__message-text"></span>\r\n      <button type="button" role="button" id="log-view-filter__message-button">(clear filter)</button>\r\n    </div>\r\n  </div>\r\n  <div id="log-view-display">\r\n'+(null!=(a=t.invokePartial(n(5),null!=e?e.dateBlocks:e,{name:"logViewDisplay",data:i,indent:"    ",helpers:r,partials:o,decorators:t.decorators}))?a:"")+"  </div>\r\n</div>"},usePartial:!0,useData:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buttonText=e.id=void 0,e.init=function(t,e){u=t,c=e},e.render=function(){return(0,i.bundlePromises)([u.getByFrequency("subject"),u.getByFrequency("source"),u.getEntries({},{date:-1},c.entriesPerPage)],["subjects","sources","entries"]).then(function(t){console.log("all docs =",t.entries.docs);var e=S(t.entries.docs),n={};return n.sources=t.sources,n.subjects=t.subjects,n.dateBlocks=e,(0,r.default)(n)},function(t){return console.log("in log-view.js .render(): bundlePromises promise was rejected")})},e.postRender=function(){l=document.getElementById(d),(0,a.insertSpacers)("#log-view-filter"),document.getElementById(d).addEventListener("click",m,!1),window.addEventListener("resize",y,!1),document.getElementById(d).addEventListener("blur",g,!0),document.getElementById(d).addEventListener("change",g,!1),document.getElementById(d).addEventListener("input",g,!1),document.getElementById(d).querySelector("#log-view-filter__sub-button-group").addEventListener("transitionend",j,!1),t=l.querySelector("#log-view-filter"),f.observe(t,{characterData:!1,childList:!1,attributes:!0,subtree:!0});var t};var r=s(n(14)),o=s(n(5)),i=n(3),a=n(7);function s(t){return t&&t.__esModule?t:{default:t}}var u=void 0,c=void 0,l=void 0,f=new MutationObserver(function(t){if(t.some(function(t){return"class"===t.attributeName||"style"===t.attributeName})){var e=l.querySelector(".fixed-position-spacer");e.style.height=document.getElementById(e.dataset.spacerTarget).getBoundingClientRect().height+"px"}}),d=e.id="log-view",h=(e.buttonText="View Log",""),p=void 0;function g(t){if(t.target.matches(".date-filter-input")&&t.target.value){var e=document.getElementById("start-date-input"),n=document.getElementById("end-date-input"),r=I();if(!e||!n||!e.value||!n.value||e.valueAsDate>r||n.valueAsDate>r||e.valueAsDate>n.valueAsDate)document.getElementById("custom-date-filter-button").classList.remove("highlight");else{var o=document.getElementById("custom-date-filter-button");o.classList.add("highlight"),o.focus()}}}function v(t,e){var n=document.createElement("div");n.textContent=e,n.classList.add("tooltip"),n.classList.add("tooltip-hidden"),n.id="tooltip";var r=document.getElementById("first-element");document.body.insertBefore(n,r);var o=t.getBoundingClientRect(),i=n.getBoundingClientRect();n.style.left=o.left-(i.width-o.width)/2+"px",n.style.top=o.top-i.height-10+"px",n.classList.remove("tooltip-hidden"),setTimeout(function(){!function(t){t.style.opacity=0,setTimeout(function(){document.body.removeChild(t)},300)}(n)},1500)}function y(){var t=document.querySelector("#"+d);t&&(t.querySelector(".active-group")&&(p&&window.cancelAnimationFrame(p),p=window.requestAnimationFrame(function(){var t=document.querySelector(".sub-button-group.active-group > .sub-button-group__button-container"),e=t.children[0],n=document.querySelector('[data-target="'+h+'"]');t.style.marginTop=e.getBoundingClientRect().top-n.getBoundingClientRect().top+"px"})))}function m(t){if(t.target.matches(".log-entry__source"))E(),x(),_("source",t.target.textContent);else if(t.target.matches(".log-entry__subject"))E(),x(),_("subject",t.target.textContent);else if(t.target.closest(".log-entry"))!function(t){var e=t.target.closest(".log-entry");if(!e)return;if(Array.from(e.classList).includes("log-entry__selected"))e.classList.remove("log-entry__selected");else{var n=Array.from(document.querySelectorAll(".log-entry"));n.forEach(function(t){return t.classList.remove("log-entry__selected")}),e.classList.add("log-entry__selected")}}(t);else if(t.target.matches(".log-view__button"))!function(t){var e=document.getElementById("log-view-filter__"+t.target.dataset.target+"-sub-buttons");if(!e)return;if(t.target.matches(".active-button"))t.target.classList.remove("active-button");else{var n=document.querySelector(".log-view__button.active-button");n&&n.classList.remove("active-button"),t.target.classList.add("active-button")}if(Array.from(e.classList).includes("active-group")){e.classList.remove("active-group");var r=e.querySelector(".sub-button-group__button-container");if(r){var o=Array.from(e.querySelectorAll(".sub-button-nav"));o.forEach(function(t){return t.style.display=""}),r.style.marginTop="0px",h=""}}else{var i=document.getElementsByClassName("active-group")[0];if(i){var a=i.querySelector(".sub-button-group__button-container");if(a){var s=Array.from(i.querySelectorAll(".sub-button-nav"));s.forEach(function(t){return t.style.display=""}),a.style.marginTop="0px"}i.classList.remove("active-group"),h=""}if(e.classList.add("active-group"),"source"===e.dataset.queryType||"subject"===e.dataset.queryType){var u=e.querySelector(".sub-button-group__button-container");h=u.firstElementChild.dataset.target}}}(t);else if(t.target.matches("#log-view-filter__message-button"))w();else if(t.target.matches(".sub-button-nav"))!function(t){var e=t.target.dataset.navDirection,n=document.getElementById("log-view-filter__sub-button-group"),r=document.querySelector(".sub-button-group.active-group > .sub-button-group__button-container"),o=Number.parseInt(r.style.marginTop)||0;if("forward"===e)(function(t,e){var n=e.getBoundingClientRect().top,r=n+e.clientHeight,o=t.lastElementChild.getBoundingClientRect().top,i=t.lastElementChild.getBoundingClientRect().bottom;if(o>=n&&o<=r&&i<=r&&i>=n)return!0;return!1})(r,n)||(h=function(){for(var t=document.querySelector('[data-target="'+h+'"]').getBoundingClientRect().top,e=Array.from(document.querySelector(".sub-button-group.active-group > .sub-button-group__button-container").children),n=0,r=0;r<e.length;r++)if(e[r].dataset.target===h){n=r;break}for(var o=n;o<e.length;o++)if(e[o].getBoundingClientRect().top!==t)return e[o].dataset.target}(),r.style.marginTop=o-n.clientHeight+"px");else if("backward"===e&&0!==o){document.querySelector('[data-target="'+h+'"]');h=function(){document.querySelector('[data-target="'+h+'"]');for(var t=Array.from(document.querySelector(".sub-button-group.active-group > .sub-button-group__button-container").children),e=0,n=0;n<t.length;n++)if(t[n].dataset.target===h){e=n;break}for(var r=t[e-1].getBoundingClientRect().top,o=e-2;o>=0;o--)if(t[o].getBoundingClientRect().top!==r)return t[o+1].dataset.target;return t[0].dataset.target}(),r.style.marginTop=o+n.clientHeight+"px"}}(t);else if(t.target.matches("#log-view__search-submit-button"))E(),x(),b(t);else if(t.target.matches("#log-view-filter__search-submit-button"))E(),x(),b(t);else if(t.target.matches(".sub-button")&&!t.target.matches("#custom-date-filter-button")){if(t.target.matches(".active-button"))return;var e=t.target.closest(".sub-button-group");!function(t){if(t.target.matches(".active-button"))t.target.classList.remove("active-button"),w();else{var e=document.querySelector(".sub-button.active-button");e&&e.classList.remove("active-button"),t.target.classList.add("active-button")}}(t),_(e.dataset.queryType,t.target.dataset.target)}else t.target.matches("#custom-date-filter-button")&&function(t){var e=document.getElementById("start-date-input"),n=document.getElementById("end-date-input"),r=e.valueAsDate,o=n.valueAsDate,i=I(),a=[];r>i&&a.push(e);o>i&&a.push(n);if(a.length>0){var s=document.getElementById("custom-date-search");return v(s,"Dates cannot be later than today!"),setTimeout(function(){a[0].focus()},750),a.includes(e)&&setTimeout(function(){e.value=""},750),void(a.includes(n)&&setTimeout(function(){n.value=""},750))}if(r>o){var l=document.getElementById("custom-date-search");return v(l,"Start date cannot be later than end date!"),void setTimeout(function(){e.focus(),e.value="",n.value=""},750)}var f={date:{}};f.date.$gte=r,f.date.$lte=o,u.getEntries(f,{date:-1},c.entriesPerPage).then(function(t){k("date-range",{startDate:A(r),endDate:A(o)},t.docs)},function(t){console.log("query failed"),console.log(t),document.getElementById("log-view-display".innerHTML="There was an error querying by date.  ALSO THIS ERROR MESSAGE NEEDS TO BE MADE MORE INFORMATIVE!")})}()}function b(t){var e=t.target.dataset.searchInput,n=document.getElementById(e),r=n.value.trim();n.value="",""!==r&&u.getBySearchString(r).then(function(t){console.log("in executeSearch; result =",t),k("search",r,t.docs)},function(t){document.getElementById("log-view-display").textContent="Error executing search for '"+r+"'"})}function w(){document.getElementById("log-view-filter__message").style.display="none";var t=document.querySelector(".sub-button.active-button");t&&t.classList.remove("active-button"),u.getAllEntries().then(function(t){var e=S(t.docs);document.getElementById("log-view-display").innerHTML=(0,o.default)(e)},function(t){console.log("promise rejected by getAllEntries()")})}function _(t,e){if("date"!==t){var n={};n[t]=e,u.getEntries(n,{date:-1},c.entriesPerPage).then(function(n){k(t,e,n.docs)},function(n){document.getElementById("log-view-display".innerHTML="There was an error fetching log entries whose <strong>"+t+"</strong> is <strong>"+e+"</strong>. Please try again later!")})}else!function(t){var e={date:{}};switch(t){case"this-week":e.date.$gt=new Date(Date.now()-6048e5);break;case"last-week":e.date.$lte=new Date(Date.now()-6048e5),e.date.$gt=new Date(Date.now()-12096e5);break;case"this-month":e.date.$gt=new Date(Date.now()-26784e5);break;case"last-month":e.date.$lte=new Date(Date.now()-26784e5),e.date.$gt=new Date(Date.now()-53568e5)}u.getEntries(e,{date:-1},c.entriesPerPage).then(function(e){k("date-keyword",t.replace("-"," "),e.docs)},function(t){console.log("query failed"),console.log(t),document.getElementById("log-view-display".innerHTML="There was an error querying by date.  ALSO THIS ERROR MESSAGE NEEDS TO BE MADE MORE INFORMATIVE!")})}(e)}function x(){var t=document.getElementById(d),e=t.querySelector(".log-view__button.active-button");e&&e.classList.remove("active-button");var n=t.querySelector(".sub-button-group.active-group");n&&n.classList.remove("active-group")}function E(){var t=document.getElementById(d).querySelector(".sub-button.active-button");t&&t.classList.remove("active-button")}function k(t,e,n){var r=document.getElementById("log-view-filter__message-text"),i="";switch(i=0===n.length?"Found no log entries ":"Currently displaying log entries ",t){case"search":i+='containing "<strong>'+e+'</strong>"';break;case"subject":case"source":i+="whose <strong>"+t+'</strong> is "<strong>'+e+'</strong>"';break;case"date-keyword":i+="created <strong>"+e+"</strong>";break;case"date-range":i+="created between <strong>"+e.startDate+"</strong> and <strong>"+e.endDate+"</strong>"}r.innerHTML=i,r.className="",r.classList.add(t);var a=S(n);window.innerWidth<600&&x(),document.getElementById("log-view-filter__message").style.display="block",document.getElementById("log-view-display").innerHTML=(0,o.default)(a)}function S(t){var e=[],n=void 0,r=-1;return t.forEach(function(t){n&&function(t,e){if(t.getUTCDate()===e.getUTCDate()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCFullYear()===e.getUTCFullYear())return!0;return!1}(n,t.date)||(n=t.date,e.push({date:A(new Date(t.date)),entries:[]}),r++),e[r].entries.push(t)}),e}function A(t){return t.toLocaleDateString("en-US",{month:"long",year:"numeric",day:"numeric"})}function I(){var t=new Date(Date.now()+864e5);return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function j(t){if(t.target.matches(".sub-button-group__button-container")){console.log("updating sub button nav");var e=t.target.getBoundingClientRect(),n=t.target.parentElement.getBoundingClientRect(),r=t.target.parentElement.querySelector(".previous-row-button"),o=t.target.parentElement.querySelector(".next-row-button");console.log("target top | parent top:",e.top,"|",n.top),console.log("target bottom | parent bottom:",e.bottom,"|",n.bottom),r.style.display=Math.abs(e.top-n.top)<1?"none":"inline-block",o.style.display=Math.abs(e.bottom-n.bottom)<1?"none":"inline-block"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.rowData=[{row:"date",rowHeadingText:"On...",lockState:"locked",inputDetails:{type:"date",additionalClasses:[],placeholder:""},hasCharMonitor:!1,hasPromptCloud:!1,promptCloudMembers:[]},{row:"source",rowHeadingText:"I learned something from...",lockState:"unlocked",inputDetails:{type:"text",additionalClasses:["short-input"],placeholder:"source"},hasCharMonitor:!0,hasPromptCloud:!0,promptCloudMembers:[]},{row:"subject",rowHeadingText:"I learned about...",lockState:"unlocked",inputDetails:{type:"text",additionalClasses:["short-input"],placeholder:"subject"},hasCharMonitor:!0,hasPromptCloud:!0,promptCloudMembers:[]},{row:"title",rowHeadingText:"Specifically, I learned...",lockState:"unlocked",inputDetails:{type:"text",additionalClasses:["long-input"],placeholder:"some cool stuff"},hasCharMonitor:!0,hasPromptCloud:!1,promptCloudMembers:[]},{row:"details",rowHeadingText:"Here are the details:",lockState:"unlocked",inputDetails:{type:"textarea",rows:5,cols:50,additionalClasses:[],placeholder:"just so I don't forget"},hasCharMonitor:!1,hasPromptCloud:!1,promptCloudMembers:[]}]},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){return'<div id="new-entry-feedback" class="new-entry-feedback">\r\n  <p class="new-entry-feedback__paragraph">The new entry was added to your learning log!</p>\r\n  <div class="new-entry-feedback__button-row">\r\n    <button type="button" role="button" class="new-entry-feedback__button new-entry-feedback__log-view-button" data-nav-target="log-view">View new entry in log</button>\r\n    <button type="button" role="button" class="new-entry-feedback__button new-entry-feedback__entry-form-button" data-nav-target="entry-form">Add another entry</button>\r\n  </div>\r\n</div>'},useData:!0})},function(t,e,n){"use strict";t.exports=function(t){if("locked"!==t)return"hidden"}},function(t,e,n){"use strict";t.exports=function(t){return"textarea"===t}},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({1:function(t,e,n,r,o){var i,a=t.lambda,s=t.escapeExpression;return'  <textarea id="'+s(a(null!=e?e.row:e,e))+'-input" class="unlocked-input-value" placeholder="'+s(a(null!=(i=null!=e?e.inputDetails:e)?i.placeholder:i,e))+'"></textarea>\r\n'},3:function(t,e,n,r,o){var i,a=t.lambda,s=t.escapeExpression,u=null!=e?e:t.nullContext||{};return'  <input \r\n         type="'+s(a(null!=(i=null!=e?e.inputDetails:e)?i.type:i,e))+'" \r\n         id="'+s(a(null!=e?e.row:e,e))+'-input" \r\n         \r\n         class="unlocked-input-value '+(null!=(i=n.each.call(u,null!=(i=null!=e?e.inputDetails:e)?i.additionalClasses:i,{name:"each",hash:{},fn:t.program(4,o,0),inverse:t.noop,data:o}))?i:"")+'" \r\n         '+(null!=(i=n.if.call(u,null!=(i=null!=e?e.inputDetails:e)?i.placeholder:i,{name:"if",hash:{},fn:t.program(6,o,0),inverse:t.noop,data:o}))?i:"")+"\r\n  >\r\n"},4:function(t,e,n,r,o){return" "+t.escapeExpression(t.lambda(e,e))+" "},6:function(t,e,n,r,o){var i;return' placeholder="'+t.escapeExpression(t.lambda(null!=(i=null!=e?e.inputDetails:e)?i.placeholder:i,e))+'" '},compiler:[7,">= 4.0.0"],main:function(t,e,r,o,i){var a,s,u=null!=e?e:t.nullContext||{};return null!=(a=r.if.call(u,(s=n(19),s&&(s.__esModule?s.default:s)).call(u,null!=(a=null!=e?e.inputDetails:e)?a.type:a,{name:"isTextarea",hash:{},data:i}),{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.program(3,i,0),data:i}))?a:""},useData:!0})},function(t,e,n){"use strict";t.exports=function(t){if("locked"===t)return"hidden"}},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({1:function(t,e,n,r,o,i,a){var s=t.lambda,u=t.escapeExpression;return'    <span class="cloud-item" data-parent-cloud="'+u(s(null!=a[1]?a[1].row:a[1],e))+'">'+u(s(e,e))+"</span>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o,i,a){var s,u,c=null!=e?e:t.nullContext||{};return'<div id="'+t.escapeExpression("function"==typeof(u=null!=(u=n.row||(null!=e?e.row:e))?u:n.helperMissing)?u.call(c,{name:"row",hash:{},data:o}):u)+'-cloud" class="cloud">\r\n'+(null!=(s=n.each.call(c,null!=e?e.promptCloudMembers:e,{name:"each",hash:{},fn:t.program(1,o,0,i,a),inverse:t.noop,data:o}))?s:"")+"</div>"},useData:!0,useDepths:!0})},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){var i,a=null!=e?e:t.nullContext||{},s=n.helperMissing,u=t.escapeExpression;return'<span id="'+u("function"==typeof(i=null!=(i=n.row||(null!=e?e.row:e))?i:s)?i.call(a,{name:"row",hash:{},data:o}):i)+'-input-char-monitor" class="char-monitor">\r\n  <span id="'+u("function"==typeof(i=null!=(i=n.row||(null!=e?e.row:e))?i:s)?i.call(a,{name:"row",hash:{},data:o}):i)+'-input-chars" class="input-chars"></span> / <span id="'+u("function"==typeof(i=null!=(i=n.row||(null!=e?e.row:e))?i:s)?i.call(a,{name:"row",hash:{},data:o}):i)+'-input-max-chars" class="max-chars"></span>\r\n</span>'},useData:!0})},function(t,e,n){var r=n(0);function o(t){return t&&(t.__esModule?t.default:t)}t.exports=(r.default||r).template({1:function(t,e,r,o,i){var a;return null!=(a=t.invokePartial(n(23),e,{name:"charMonitor",data:i,indent:"        ",helpers:r,partials:o,decorators:t.decorators}))?a:""},3:function(t,e,r,o,i){var a;return null!=(a=t.invokePartial(n(22),e,{name:"promptCloud",data:i,indent:"        ",helpers:r,partials:o,decorators:t.decorators}))?a:""},compiler:[7,">= 4.0.0"],main:function(t,e,r,i,a){var s,u=t.lambda,c=t.escapeExpression,l=null!=e?e:t.nullContext||{};return'\r\n<div id="'+c(u(null!=e?e.row:e,e))+'-row" class="entry-form__row">\r\n  <div id="'+c(u(null!=e?e.row:e,e))+'-heading" class="entry-form__row-heading">'+c(u(null!=e?e.rowHeadingText:e,e))+'</div>\r\n  <div id="'+c(u(null!=e?e.row:e,e))+'-content" class="entry-form__row-content">\r\n    <div class="unlocked-input '+c(o(n(21)).call(l,null!=e?e.lockState:e,{name:"unlockedInputClass",hash:{},data:a}))+'">\r\n'+(null!=(s=t.invokePartial(n(20),e,{name:"input",data:a,indent:"      ",helpers:r,partials:i,decorators:t.decorators}))?s:"")+(null!=(s=r.if.call(l,null!=e?e.hasCharMonitor:e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a}))?s:"")+(null!=(s=r.if.call(l,null!=e?e.hasPromptCloud:e,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a}))?s:"")+'    </div>\r\n    \r\n    <div class="locked-input '+c(o(n(18)).call(l,null!=e?e.lockState:e,{name:"lockedInputClass",hash:{},data:a}))+'">\r\n      <span id="'+c(u(null!=e?e.row:e,e))+'-entry" class="locked-input-value"></span>\r\n      <button id="edit-'+c(u(null!=e?e.row:e,e))+'-button" type="button" role="button" class="locked-input-button">Edit</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n'},usePartial:!0,useData:!0})},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({1:function(t,e,r,o,i){var a;return null!=(a=t.invokePartial(n(24),e,{name:"entryFormRow",data:i,indent:"    ",helpers:r,partials:o,decorators:t.decorators}))?a:""},compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o){var i;return'<div id="entry-form" class="top-level-view">\r\n'+(null!=(i=n.each.call(null!=e?e:t.nullContext||{},null!=e?e.rows:e,{name:"each",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o}))?i:"")+'  \r\n  <div class="entry-form__button-row">\r\n    <button type="button" class="reset-button" id="reset-button" role="button">Reset</button>\r\n    <button type="button" class="submit-button" id="submit-button" role="button">Add To Log</button>\r\n  </div>\r\n</div>'},usePartial:!0,useData:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buttonText=e.id=void 0,e.init=function(t,e,n){l=t,u=n,c=e,d()},e.render=function(){return console.log("ENTRY-FORM: calling getSourcesAndSubjects()"),d().then(function(t){return(0,r.default)({rows:i.rowData})},function(t){return(0,r.default)({rows:i.rowData})})},e.postRender=function(){document.getElementById("entry-form").addEventListener("click",y,!1),document.getElementById("entry-form").addEventListener("blur",m,!0),document.getElementById("entry-form").addEventListener("focus",v,!0),document.getElementById("entry-form").addEventListener("change",b,!1),document.getElementById("entry-form").addEventListener("input",b,!1),document.getElementById("source-input").maxLength=u.sourceLengthUser,document.getElementById("source-input-chars").textContent=document.getElementById("source-input").textLength,document.getElementById("source-input-max-chars").textContent=u.sourceLengthUser,document.getElementById("subject-input").maxLength=u.subjectLengthUser,document.getElementById("subject-input-chars").textContent=document.getElementById("subject-input").textLength,document.getElementById("subject-input-max-chars").textContent=u.subjectLengthUser,document.getElementById("title-input").maxLength=u.titleLengthUser,document.getElementById("title-input-chars").textContent=document.getElementById("title-input").textLength,document.getElementById("title-input-max-chars").textContent=u.titleLengthUser,console.log("== entry-form initializeDate()"),document.getElementById("date-entry").textContent=x(new Date),document.getElementById("date-input").valueAsDate=new Date(Date.now())},e.updateSources=p,e.updateSubjects=g,e.updateSettings=function(t){u=t};var r=s(n(25)),o=s(n(17)),i=n(16),a=n(3);function s(t){return t&&t.__esModule?t:{default:t}}var u=void 0,c=void 0,l=void 0,f=["date","source","subject","title","details"];e.id="entry-form",e.buttonText="Add Items";function d(){return(0,a.bundlePromises)([l.getAll("source"),l.getAll("subject")],["sources","subjects"]).then(function(t){console.log("entryForm.getSourcesAndSubjects()"),console.log("sources =",t.sources),console.log("subjects =",t.subjects),p(t.sources),g(t.subjects)},function(t){return console.log("problem in bundlePromises()")})}function h(t){console.log("=== entry-form: adding item to db"),l.add(t).then(function(t){return console.log("ENTRY FORM: got result from promise")},function(t){return console.log("ENTRY FORM: got error from promise")}).finally(function(){var t=(0,o.default)({});document.getElementById("overlay-content").innerHTML=t,document.getElementById("new-entry-feedback").addEventListener("click",function(t){"log-view"===t.target.dataset.navTarget?c.navigateTo("log-view"):"entry-form"===t.target.dataset.navTarget&&(document.getElementById("overlay").style.display="none",c.navigateTo("entry-form"))})})}function p(t){i.rowData.filter(function(t){return"source"===t.row})[0].promptCloudMembers=t.slice(0,u.sourcePromptsUser)}function g(t){i.rowData.filter(function(t){return"subject"===t.row})[0].promptCloudMembers=t.slice(0,u.subjectPromptsUser)}function v(t){t.target.matches(".unlocked-input-value")&&function(t){t.target.classList.remove("error")}(t)}function y(t){console.log("handleClick"),t.target.matches(".locked-input-button")?function(t){t.target.parentElement.classList.add("hidden"),t.target.parentElement.parentElement.querySelector(".unlocked-input").classList.remove("hidden");var e=t.target.id.replace(/edit-|-button/g,"");document.getElementById(e+"-input").focus()}(t):t.target.matches(".cloud-item")?function(t){console.log("=== fillInputAndLock()");var e=t.target.dataset.parentCloud,n=document.getElementById(e+"-input");n.value=t.target.textContent,w(n),document.getElementById(e+"-entry").textContent=t.target.textContent,t.target.parentElement.parentElement.classList.add("hidden"),t.target.parentElement.parentElement.nextElementSibling.classList.remove("hidden");var r=f[f.indexOf(e)+1];document.getElementById(r+"-input").focus()}(t):t.target.matches("#reset-button")?function(){Array.from(document.getElementsByClassName("unlocked-input-value")).forEach(function(t){t.value="",t.parentElement.classList.remove("hidden")}),Array.from(document.getElementsByClassName("locked-input-value")).forEach(function(t){t.textContent="",t.parentElement.classList.add("hidden")});var t=document.getElementById("date-input");t.valueAsDate=new Date(Date.now()),t.parentElement.classList.add("hidden");var e=document.getElementById("date-entry");e.textContent=x(new Date(Date.now())),e.parentElement.classList.remove("hidden"),Array.from(document.getElementsByClassName("char-monitor")).forEach(function(t){t.firstElementChild.textContent="0"}),Array.from(document.getElementsByClassName("entry-form__content")).forEach(function(t){t.classList.remove("error")}),window.scrollTo({top:0,behavior:"smooth"})}():t.target.matches("#submit-button")&&function(t){console.log("=== checkForm()");var e,n=Array.from(document.getElementsByClassName("unlocked-input-value")),r=[],o={};if(n.forEach(function(t){""===t.value&&r.push(t.id.replace("-input",""))}),r.length>0)console.log("\tthere are some errors"),r.forEach(function(t){document.getElementById(t+"-input").classList.add("error")});else{n.forEach(function(t){e=t.id.replace("-input",""),"date-input"===t.id?o[e]=t.valueAsDate:o[e]=t.value}),console.log("newLogData =",o);var i=document.getElementById("overlay");i.style.height=document.getElementsByTagName("body")[0].getBoundingClientRect().height+"px",i.style.display="flex",h(o)}}()}function m(t){if(null!=t.relatedTarget&&t.target.matches(".unlocked-input-value"))if("date-input"===t.target.id){if("Year"===t.originalTarget.getAttribute("aria-label")){var e=t.originalTarget.getAttribute("rawvalue")+t.target.value.substring(4);t.target.value=e,t.preventDefault(),_(t)}}else""!==t.target.value.trim()&&(t.preventDefault(),_(t))}function b(t){"source-input"!==t.target.id&&"subject-input"!==t.target.id&&"title-input"!==t.target.id||w(t.target)}function w(t){document.getElementById(t.id+"-chars").textContent=t.textLength}function _(t){var e,n,r=t.target;if(""!==r.value.trim()){var o=r.id.replace("-input","");"date"===o?n=x(r.valueAsDate):"title"===o?(n=(e=r.value.split(" ")).slice(0,7).join(" "),e.length>7&&(n+="...")):"details"===o?(n=(e=r.value.split(" ")).slice(0,15).join(" "),e.length>15&&(n+="...")):n=r.value,document.getElementById(o+"-entry").textContent=n,r.parentElement.classList.add("hidden"),r.parentElement.parentElement.querySelector(".locked-input").classList.remove("hidden");var i=f[f.indexOf(o)+1];i?document.getElementById(i+"-input").focus():document.getElementById("submit-button").focus()}}function x(t){return t.toLocaleDateString("en-US",{month:"long",year:"numeric",day:"numeric",timeZone:"UTC"})}},function(t,e,n){"use strict";(function(n){e.__esModule=!0,e.default=function(t){var e=void 0!==n?n:window,r=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=r),t}},t.exports=e.default}).call(this,n(4))},function(t,e,n){"use strict";e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,n=s.COMPILER_REVISION;if(e!==n){if(e<n){var r=s.REVISION_CHANGES[n],o=s.REVISION_CHANGES[e];throw new a.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+o+").")}throw new a.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}},e.template=function(t,e){if(!e)throw new a.default("No environment passed to template");if(!t||!t.main)throw new a.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var n={strict:function(t,e){if(!(e in t))throw new a.default('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var n=t.length,r=0;r<n;r++)if(t[r]&&null!=t[r][e])return t[r][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:o.escapeExpression,invokePartial:function(n,r,i){i.hash&&(r=o.extend({},r,i.hash),i.ids&&(i.ids[0]=!0));n=e.VM.resolvePartial.call(this,n,r,i);var s=e.VM.invokePartial.call(this,n,r,i);null==s&&e.compile&&(i.partials[i.name]=e.compile(n,t.compilerOptions,e),s=i.partials[i.name](r,i));if(null!=s){if(i.indent){for(var u=s.split("\n"),c=0,l=u.length;c<l&&(u[c]||c+1!==l);c++)u[c]=i.indent+u[c];s=u.join("\n")}return s}throw new a.default("The partial "+i.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var n=t[e];return n.decorator=t[e+"_d"],n},programs:[],program:function(t,e,n,r,o){var i=this.programs[t],a=this.fn(t);return e||o||r||n?i=u(this,t,a,e,n,r,o):i||(i=this.programs[t]=u(this,t,a)),i},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=o.extend({},e,t)),n},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:t.compiler};function r(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=o.data;r._setup(o),!o.partial&&t.useData&&(i=function(t,e){e&&"root"in e||((e=e?s.createFrame(e):{}).root=t);return e}(e,i));var a=void 0,u=t.useBlockParams?[]:void 0;function c(e){return""+t.main(n,e,n.helpers,n.partials,i,u,a)}return t.useDepths&&(a=o.depths?e!=o.depths[0]?[e].concat(o.depths):o.depths:[e]),(c=l(t.main,c,n,o.depths||[],i,u))(e,o)}return r.isTop=!0,r._setup=function(r){r.partial?(n.helpers=r.helpers,n.partials=r.partials,n.decorators=r.decorators):(n.helpers=n.merge(r.helpers,e.helpers),t.usePartial&&(n.partials=n.merge(r.partials,e.partials)),(t.usePartial||t.useDecorators)&&(n.decorators=n.merge(r.decorators,e.decorators)))},r._child=function(e,r,o,i){if(t.useBlockParams&&!o)throw new a.default("must pass block params");if(t.useDepths&&!i)throw new a.default("must pass parent depths");return u(n,e,t[e],r,0,o,i)},r},e.wrapProgram=u,e.resolvePartial=function(t,e,n){t?t.call||n.name||(n.name=t,t=n.partials[t]):t="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name];return t},e.invokePartial=function(t,e,n){var r=n.data&&n.data["partial-block"];n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var i=void 0;n.fn&&n.fn!==c&&function(){n.data=s.createFrame(n.data);var t=n.fn;i=n.data["partial-block"]=function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return n.data=s.createFrame(n.data),n.data["partial-block"]=r,t(e,n)},t.partials&&(n.partials=o.extend({},n.partials,t.partials))}();void 0===t&&i&&(t=i);if(void 0===t)throw new a.default("The partial "+n.name+" could not be found");if(t instanceof Function)return t(e,n)},e.noop=c;var r,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),i=n(2),a=(r=i)&&r.__esModule?r:{default:r},s=n(8);function u(t,e,n,r,o,i,a){function s(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=a;return!a||e==a[0]||e===t.nullContext&&null===a[0]||(s=[e].concat(a)),n(t,e,t.helpers,t.partials,o.data||r,i&&[o.blockParams].concat(i),s)}return(s=l(n,s,t,a,r,i)).program=e,s.depth=a?a.length:0,s.blockParams=o||0,s}function c(){return""}function l(t,e,n,r,i,a){if(t.decorator){var s={};e=t.decorator(e,s,n,r&&r[0],i,a,r),o.extend(e,s)}return e}},function(t,e,n){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=r.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];console[e].apply(console,r)}}};e.default=o,t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1);e.default=function(t){t.registerDecorator("inline",function(t,e,n,o){var i=t;return e.partials||(e.partials={},i=function(o,i){var a=n.partials;n.partials=r.extend({},a,e.partials);var s=t(o,i);return n.partials=a,s}),e.partials[o.args[0]]=o.fn,i})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0,e.registerDefaultDecorators=function(t){i.default(t)};var r,o=n(31),i=(r=o)&&r.__esModule?r:{default:r}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1);e.default=function(t){t.registerHelper("with",function(t,e){r.isFunction(t)&&(t=t.call(this));var n=e.fn;if(r.isEmpty(t))return e.inverse(this);var o=e.data;return e.data&&e.ids&&((o=r.createFrame(e.data)).contextPath=r.appendContextPath(e.data.contextPath,e.ids[0])),n(t,{data:o,blockParams:r.blockParams([t],[o&&o.contextPath])})})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",function(){for(var e=[void 0],n=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)e.push(arguments[r]);var o=1;null!=n.hash.level?o=n.hash.level:n.data&&null!=n.data.level&&(o=n.data.level),e[0]=o,t.log.apply(t,e)})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1);e.default=function(t){t.registerHelper("if",function(t,e){return r.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||r.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers.if.call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r,o=n(2),i=(r=o)&&r.__esModule?r:{default:r};e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r,o=n(1),i=n(2),a=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){t.registerHelper("each",function(t,e){if(!e)throw new a.default("Must pass iterator to #each");var n=e.fn,r=e.inverse,i=0,s="",u=void 0,c=void 0;function l(e,r,i){u&&(u.key=e,u.index=r,u.first=0===r,u.last=!!i,c&&(u.contextPath=c+e)),s+=n(t[e],{data:u,blockParams:o.blockParams([t[e],e],[c+e,null])})}if(e.data&&e.ids&&(c=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(u=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var f=t.length;i<f;i++)i in t&&l(i,i,i===t.length-1);else{var d=void 0;for(var h in t)t.hasOwnProperty(h)&&(void 0!==d&&l(d,i-1),d=h,i++);void 0!==d&&l(d,i-1,!0)}return 0===i&&(s=r(this)),s})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1);e.default=function(t){t.registerHelper("blockHelperMissing",function(e,n){var o=n.inverse,i=n.fn;if(!0===e)return i(this);if(!1===e||null==e)return o(this);if(r.isArray(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):o(this);if(n.data&&n.ids){var a=r.createFrame(n.data);a.contextPath=r.appendContextPath(n.data.contextPath,n.name),n={data:a}}return i(e,n)})},t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),i.default(t),a.default(t),s.default(t),u.default(t),c.default(t),l.default(t)};var o=r(n(39)),i=r(n(38)),a=r(n(37)),s=r(n(36)),u=r(n(35)),c=r(n(34)),l=r(n(33))},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.__esModule=!0;var i=o(n(8)),a=r(n(29)),s=r(n(2)),u=o(n(1)),c=o(n(28)),l=r(n(27));function f(){var t=new i.HandlebarsEnvironment;return u.extend(t,i),t.SafeString=a.default,t.Exception=s.default,t.Utils=u,t.escapeExpression=u.escapeExpression,t.VM=c,t.template=function(e){return c.template(e,t)},t}var d=f();d.create=f,l.default(d),d.default=d,e.default=d,t.exports=e.default},function(t,e,n){var r=n(0);t.exports=(r.default||r).template({1:function(t,e,n,r,o,i,a){var s,u=t.escapeExpression,c=null!=e?e:t.nullContext||{},l=n.helperMissing;return'      <button class="'+u(t.lambda(null!=a[1]?a[1].buttonClass:a[1],e))+'" id="'+u("function"==typeof(s=null!=(s=n.targetId||(null!=e?e.targetId:e))?s:l)?s.call(c,{name:"targetId",hash:{},data:o}):s)+'-button" type="button" role="button" data-nav-target="'+u("function"==typeof(s=null!=(s=n.targetId||(null!=e?e.targetId:e))?s:l)?s.call(c,{name:"targetId",hash:{},data:o}):s)+'">'+u("function"==typeof(s=null!=(s=n.buttonText||(null!=e?e.buttonText:e))?s:l)?s.call(c,{name:"buttonText",hash:{},data:o}):s)+"</button>\r\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,r,o,i,a){var s;return'<div id="nav">\r\n  <div id="title">\r\n    <span style="color: var(--color-1-dark)">My</span>\r\n    <span style="color: var(--color-2-dark)">Learning</span>\r\n    <span style="color: var(--color-3-dark)">Log</span>\r\n  </div>\r\n  \r\n  <nav id="nav-buttons" class="nav__button-group">\r\n'+(null!=(s=n.each.call(null!=e?e:t.nullContext||{},null!=e?e.navTargets:e,{name:"each",hash:{},fn:t.program(1,o,0,i,a),inverse:t.noop,data:o}))?s:"")+"  </nav>\r\n</div>\r\n"},useData:!0,useDepths:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Navigator=void 0;var r,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(42),a=(r=i)&&r.__esModule?r:{default:r};e.Navigator=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._navTargets={},this._navTargets=e,this._containerId=n,this._currentlyVisibleId="",this._currentNavTarget={},this._renderedNavTarget="",this._init()}return o(t,[{key:"_init",value:function(){document.getElementById(this._containerId).addEventListener("animationend",this._handleAnimationEnd.bind(this),!1)}},{key:"render",value:function(){var t={buttonClass:"nav__button",navTargets:[]};return this._navTargets.forEach(function(e){t.navTargets.push({targetId:e.id,buttonText:e.buttonText})}),(0,a.default)(t)}},{key:"postRender",value:function(){var t=this;Array.from(document.getElementsByClassName("nav__button")).forEach(function(e){e.addEventListener("click",function(){t._currentlyVisibleId!==e.dataset.navTarget&&t.navigateTo(e.dataset.navTarget)})})}},{key:"navigateTo",value:function(t){var e=this._navTargets.filter(function(e){return e.id===t})[0];if(e){this._currentNavTarget=e,this.fetchNewView(),""!==this._currentlyVisibleId&&document.getElementById(this._currentlyVisibleId+"-button").classList.remove("nav__button-active"),document.getElementById(t+"-button").classList.add("nav__button-active"),document.getElementById(this._containerId).classList.add("fading-out");var n=document.getElementById("overlay");"flex"===n.style.display&&n.classList.add("fading-out")}}},{key:"fetchNewView",value:function(){var t=this;this._currentNavTarget.render().then(function(e){t._renderedNavTarget=e},function(e){t._renderedNavTarget="error loading "+t._currentNavTarget.id})}},{key:"changeViews",value:function(){var t=document.getElementById("overlay");t.style.display="none",t.style.opacity=1,t.classList.remove("fading-out");var e=document.getElementById(this._containerId);""!==this._renderedNavTarget?(e.innerHTML=this._renderedNavTarget,this._currentNavTarget.postRender()):e.innerHTML=this._generateErrorMessage(this._currentNavTarget),e.classList.remove("fading-out"),e.classList.add("fading-in"),this._currentlyVisibleId=this._currentNavTarget.id,this._currentNavTarget={},this._renderedNavTarget="",this.scrollToTop(),console.log("at end of changeViews, this._currentlyVisibleId =",this._currentlyVisibleId)}},{key:"scrollToTop",value:function(){setTimeout(function(){window.scrollTo({top:0,behavior:"smooth"})},100)}},{key:"_handleAnimationEnd",value:function(){var t=document.getElementById(this._containerId);t.matches(".fading-in")?t.classList.remove("fading-in"):t.matches(".fading-out")&&this.changeViews()}},{key:"_generateErrorMessage",value:function(t){return"Error loading "+t}}]),t}()},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,f=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var t=s(d);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,o,i,a,s,u=1,c={},l=!1,f=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){p(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return c[u]=o,r(u),u++},d.clearImmediate=h}function h(t){delete c[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{h(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(4),n(44))},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(45),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(t,e,n){(function(e){var n,r;r=function(){return function(t,e,r){function o(r,a){if(!e[r]){if(!t[r]){if(!a&&("function"==typeof n&&n))return n(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+r+"'")}var s=e[r]={exports:{}};t[r][0].call(s.exports,function(e){var n=t[r][1][e];return o(n||e)},s,s.exports)}return e[r].exports}for(var i="function"==typeof n&&n,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){var r=t("__browserify_process");r.EventEmitter||(r.EventEmitter=function(){});var o=n.EventEmitter=r.EventEmitter,i="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};o.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},o.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||i(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(i(e)){n=Array.prototype.slice.call(arguments,1);for(var r=e.slice(),o=0,a=r.length;o<a;o++)r[o].apply(this,n);return!0}return!1},o.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(i(this._events[t])){var n;if(!this._events[t].warned)(n=void 0!==this._events.maxListeners?this._events.maxListeners:10)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace());this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},o.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(i(n)){var r=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}(n,e);if(r<0)return this;n.splice(r,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},o.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},o.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),i(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},o.listenerCount=function(t,e){return t._events&&t._events[e]?"function"==typeof t._events[e]?1:t._events[e].length:0}},{__browserify_process:4}],2:[function(t,e,n){var r=t("__browserify_process");function o(t,e){for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}function i(t,e){for(var n=0,r=t.length;r>=0;r--){var o=t[r];"."==o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var a=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){for(var t="",e=!1,n=arguments.length;n>=-1&&!e;n--){var a=n>=0?arguments[n]:r.cwd();"string"==typeof a&&a&&(t=a+"/"+t,e="/"===a.charAt(0))}return t=i(o(t.split("/"),function(t){return!!t}),!e).join("/"),(e?"/":"")+t||"."},n.normalize=function(t){var e="/"===t.charAt(0),n="/"===t.slice(-1);return(t=i(o(t.split("/"),function(t){return!!t}),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(o(t,function(t,e){return t&&"string"==typeof t}).join("/"))},n.dirname=function(t){var e=a.exec(t)[1]||"";return e?1===e.length?e:e.substring(0,e.length-1):"."},n.basename=function(t,e){var n=a.exec(t)[2]||"";return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return a.exec(t)[3]||""},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var o=r(t.split("/")),i=r(e.split("/")),a=Math.min(o.length,i.length),s=a,u=0;u<a;u++)if(o[u]!==i[u]){s=u;break}var c=[];for(u=s;u<o.length;u++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},n.sep="/"},{__browserify_process:4}],3:[function(t,e,n){t("events");function r(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)}function o(t){"object"==typeof t&&Object.prototype.toString.call(t)}function i(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)}n.isArray=r,n.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},n.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(t,e,u,c){var l=[],f=function(t,e){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r={special:"cyan",number:"blue",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"}[e];return r?"["+n[r][0]+"m"+t+"["+n[r][1]+"m":t};return c||(f=function(t,e){return t}),function t(u,c){if(u&&"function"==typeof u.inspect&&u!==n&&(!u.constructor||u.constructor.prototype!==u))return u.inspect(c);switch(typeof u){case"undefined":return f("undefined","undefined");case"string":var d="'"+JSON.stringify(u).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return f(d,"string");case"number":return f(""+u,"number");case"boolean":return f(""+u,"boolean")}if(null===u)return f("null","null");var h,p,g,v=a(u),y=e?s(u):v;if("function"==typeof u&&0===y.length){if(o(u))return f(""+u,"regexp");var m=u.name?": "+u.name:"";return f("[Function"+m+"]","special")}if(i(u)&&0===y.length)return f(u.toUTCString(),"date");if(r(u)?(p="Array",g=["[","]"]):(p="Object",g=["{","}"]),"function"==typeof u){var b=u.name?": "+u.name:"";h=o(u)?" "+u:" [Function"+b+"]"}else h="";if(i(u)&&(h=" "+u.toUTCString()),0===y.length)return g[0]+h+g[1];if(c<0)return o(u)?f(""+u,"regexp"):f("[Object]","special");l.push(u);var w=y.map(function(e){var n,o;if(u.__lookupGetter__&&(u.__lookupGetter__(e)?o=u.__lookupSetter__(e)?f("[Getter/Setter]","special"):f("[Getter]","special"):u.__lookupSetter__(e)&&(o=f("[Setter]","special"))),v.indexOf(e)<0&&(n="["+e+"]"),o||(l.indexOf(u[e])<0?(o=null===c?t(u[e]):t(u[e],c-1)).indexOf("\n")>-1&&(o=r(u)?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=f("[Circular]","special")),void 0===n){if("Array"===p&&e.match(/^\d+$/))return o;(n=JSON.stringify(""+e)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=f(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=f(n,"string"))}return n+": "+o});l.pop();return w=w.reduce(function(t,e){return e.indexOf("\n"),t+e.length+1},0)>50?g[0]+(""===h?"":h+"\n ")+" "+w.join(",\n  ")+" "+g[1]:g[0]+h+" "+w.join(", ")+" "+g[1]}(t,void 0===u?2:u)};n.log=function(t){},n.pump=null;var a=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},s=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.hasOwnProperty.call(t,n)&&e.push(n);return e},u=Object.create||function(t,e){var n;if(null===t)n={__proto__:null};else{if("object"!=typeof t)throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var r=function(){};r.prototype=t,(n=new r).__proto__=t}return void 0!==e&&Object.defineProperties&&Object.defineProperties(n,e),n};n.inherits=function(t,e){t.super_=e,t.prototype=u(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})};var c=/%[sdj%]/g;n.format=function(t){if("string"!=typeof t){for(var e=[],r=0;r<arguments.length;r++)e.push(n.inspect(arguments[r]));return e.join(" ")}r=1;for(var o=arguments,i=o.length,a=String(t).replace(c,function(t){if("%%"===t)return"%";if(r>=i)return t;switch(t){case"%s":return String(o[r++]);case"%d":return Number(o[r++]);case"%j":return JSON.stringify(o[r++]);default:return t}}),s=o[r];r<i;s=o[++r])a+=null===s||"object"!=typeof s?" "+s:" "+n.inspect(s);return a}},{events:1}],4:[function(t,e,n){var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;e!==window&&null!==e||"process-tick"!==t.data||(t.stopPropagation(),n.length>0&&n.shift()())},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],5:[function(t,e,n){var r=t("./model"),o=t("underscore");function i(t,e,n){this.db=t,this.query=e||{},n&&(this.execFn=n)}i.prototype.limit=function(t){return this._limit=t,this},i.prototype.skip=function(t){return this._skip=t,this},i.prototype.sort=function(t){return this._sort=t,this},i.prototype.projection=function(t){return this._projection=t,this},i.prototype.project=function(t){var e,n,r,i=[],a=this;return void 0===this._projection||0===Object.keys(this._projection).length?t:(e=0!==this._projection._id,this._projection=o.omit(this._projection,"_id"),(r=Object.keys(this._projection)).forEach(function(t){if(void 0!==n&&a._projection[t]!==n)throw new Error("Can't both keep and omit fields except for _id");n=a._projection[t]}),t.forEach(function(t){var a=1===n?o.pick(t,r):o.omit(t,r);e?a._id=t._id:delete a._id,i.push(a)}),i)},i.prototype._exec=function(t){var e,n,o,i=this.db.getCandidates(this.query),a=[],s=0,u=0,c=this,l=null;try{for(e=0;e<i.length;e+=1)if(r.match(i[e],this.query))if(this._sort)a.push(i[e]);else if(this._skip&&this._skip>u)u+=1;else if(a.push(i[e]),s+=1,this._limit&&this._limit<=s)break}catch(e){return t(e)}if(this._sort){n=Object.keys(this._sort);var f=[];for(e=0;e<n.length;e++)o=n[e],f.push({key:o,direction:c._sort[o]});a.sort(function(t,e){var n,o,i;for(i=0;i<f.length;i++)if(0!==(o=(n=f[i]).direction*r.compareThings(r.getDotValue(t,n.key),r.getDotValue(e,n.key),c.db.compareStrings)))return o;return 0});var d=this._limit||a.length,h=this._skip||0;a=a.slice(h,h+d)}try{a=this.project(a)}catch(t){l=t,a=void 0}return this.execFn?this.execFn(l,a,t):t(l,a)},i.prototype.exec=function(){this.db.executor.push({this:this,fn:this._exec,arguments:arguments})},e.exports=i},{"./model":10,underscore:19}],6:[function(t,e,n){e.exports.uid=function(t){return function(t){var e,n,r,o,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=t.length%3,s="";for(r=0,n=t.length-a;r<n;r+=3)e=(t[r]<<16)+(t[r+1]<<8)+t[r+2],s+=i[(o=e)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o];switch(a){case 1:e=t[t.length-1],s+=i[e>>2],s+=i[e<<4&63],s+="==";break;case 2:e=(t[t.length-2]<<8)+t[t.length-1],s+=i[e>>10],s+=i[e>>4&63],s+=i[e<<2&63],s+="="}return s}(function(t){for(var e,n=new Array(t),r=0;r<t;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n}(Math.ceil(Math.max(8,2*t)))).replace(/[+\/]/g,"").slice(0,t)}},{}],7:[function(t,e,n){var r=t("./customUtils"),o=t("./model"),i=t("async"),a=t("./executor"),s=t("./indexes"),u=t("util"),c=t("underscore"),l=t("./persistence"),f=t("./cursor");function d(t){var e;"string"==typeof t?(e=t,this.inMemoryOnly=!1):(e=(t=t||{}).filename,this.inMemoryOnly=t.inMemoryOnly||!1,this.autoload=t.autoload||!1,this.timestampData=t.timestampData||!1),e&&"string"==typeof e&&0!==e.length?this.filename=e:(this.filename=null,this.inMemoryOnly=!0),this.compareStrings=t.compareStrings,this.persistence=new l({db:this,nodeWebkitAppName:t.nodeWebkitAppName,afterSerialization:t.afterSerialization,beforeDeserialization:t.beforeDeserialization,corruptAlertThreshold:t.corruptAlertThreshold}),this.executor=new a,this.inMemoryOnly&&(this.executor.ready=!0),this.indexes={},this.indexes._id=new s({fieldName:"_id",unique:!0}),this.autoload&&this.loadDatabase(t.onload||function(t){if(t)throw t})}u.inherits(d,t("events").EventEmitter),d.prototype.loadDatabase=function(){this.executor.push({this:this.persistence,fn:this.persistence.loadDatabase,arguments:arguments},!0)},d.prototype.getAllData=function(){return this.indexes._id.getAll()},d.prototype.resetIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].reset(t)})},d.prototype.ensureIndex=function(t,e){var n,r=e||function(){};if(!(t=t||{}).fieldName)return(n=new Error("Cannot create an index without a fieldName")).missingFieldName=!0,r(n);if(this.indexes[t.fieldName])return r(null);this.indexes[t.fieldName]=new s(t);try{this.indexes[t.fieldName].insert(this.getAllData())}catch(e){return delete this.indexes[t.fieldName],r(e)}this.persistence.persistNewState([{$$indexCreated:t}],function(t){return r(t||null)})},d.prototype.removeIndex=function(t,e){var n=e||function(){};delete this.indexes[t],this.persistence.persistNewState([{$$indexRemoved:t}],function(t){return n(t||null)})},d.prototype.addToIndexes=function(t){var e,n,r,o=Object.keys(this.indexes);for(e=0;e<o.length;e+=1)try{this.indexes[o[e]].insert(t)}catch(t){n=e,r=t;break}if(r){for(e=0;e<n;e+=1)this.indexes[o[e]].remove(t);throw r}},d.prototype.removeFromIndexes=function(t){var e=this;Object.keys(this.indexes).forEach(function(n){e.indexes[n].remove(t)})},d.prototype.updateIndexes=function(t,e){var n,r,o,i=Object.keys(this.indexes);for(n=0;n<i.length;n+=1)try{this.indexes[i[n]].update(t,e)}catch(t){r=n,o=t;break}if(o){for(n=0;n<r;n+=1)this.indexes[i[n]].revertUpdate(t,e);throw o}},d.prototype.getCandidates=function(t){var e,n=Object.keys(this.indexes);return e=[],Object.keys(t).forEach(function(n){("string"==typeof t[n]||"number"==typeof t[n]||"boolean"==typeof t[n]||u.isDate(t[n])||null===t[n])&&e.push(n)}),(e=c.intersection(e,n)).length>0?this.indexes[e[0]].getMatching(t[e[0]]):(e=[],Object.keys(t).forEach(function(n){t[n]&&t[n].hasOwnProperty("$in")&&e.push(n)}),(e=c.intersection(e,n)).length>0?this.indexes[e[0]].getMatching(t[e[0]].$in):(e=[],Object.keys(t).forEach(function(n){t[n]&&(t[n].hasOwnProperty("$lt")||t[n].hasOwnProperty("$lte")||t[n].hasOwnProperty("$gt")||t[n].hasOwnProperty("$gte"))&&e.push(n)}),(e=c.intersection(e,n)).length>0?this.indexes[e[0]].getBetweenBounds(t[e[0]]):this.getAllData()))},d.prototype._insert=function(t,e){var n,r=e||function(){};try{n=this.prepareDocumentForInsertion(t),this._insertInCache(n)}catch(t){return r(t)}this.persistence.persistNewState(u.isArray(n)?n:[n],function(t){return t?r(t):r(null,o.deepCopy(n))})},d.prototype.createNewId=function(){var t=r.uid(16);return this.indexes._id.getMatching(t).length>0&&(t=this.createNewId()),t},d.prototype.prepareDocumentForInsertion=function(t){var e,n=this;if(u.isArray(t))e=[],t.forEach(function(t){e.push(n.prepareDocumentForInsertion(t))});else{void 0===(e=o.deepCopy(t))._id&&(e._id=this.createNewId());var r=new Date;this.timestampData&&void 0===e.createdAt&&(e.createdAt=r),this.timestampData&&void 0===e.updatedAt&&(e.updatedAt=r),o.checkObject(e)}return e},d.prototype._insertInCache=function(t){u.isArray(t)?this._insertMultipleDocsInCache(t):this.addToIndexes(t)},d.prototype._insertMultipleDocsInCache=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.addToIndexes(t[e])}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.removeFromIndexes(t[e]);throw r}},d.prototype.insert=function(){this.executor.push({this:this,fn:this._insert,arguments:arguments})},d.prototype.count=function(t,e){var n=new f(this,t,function(t,e,n){return t?n(t):n(null,e.length)});if("function"!=typeof e)return n;n.exec(e)},d.prototype.find=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new f(this,t,function(t,e,n){var r,i=[];if(t)return n(t);for(r=0;r<e.length;r+=1)i.push(o.deepCopy(e[r]));return n(null,i)});if(r.projection(e),"function"!=typeof n)return r;r.exec(n)},d.prototype.findOne=function(t,e,n){switch(arguments.length){case 1:e={};break;case 2:"function"==typeof e&&(n=e,e={})}var r=new f(this,t,function(t,e,n){return t?n(t):1===e.length?n(null,o.deepCopy(e[0])):n(null,null)});if(r.projection(e).limit(1),"function"!=typeof n)return r;r.exec(n)},d.prototype._update=function(t,e,n,r){var a,s,u,l,d=this,h=0;"function"==typeof n&&(r=n,n={}),a=r||function(){},s=void 0!==n.multi&&n.multi,u=void 0!==n.upsert&&n.upsert,i.waterfall([function(n){if(!u)return n();new f(d,t).limit(1)._exec(function(r,i){if(r)return a(r);if(1===i.length)return n();var s;try{o.checkObject(e),s=e}catch(n){try{s=o.modify(o.deepCopy(t,!0),e)}catch(r){return a(r)}}return d._insert(s,function(t,e){return t?a(t):a(null,1,e)})})},function(){var r,i=d.getCandidates(t),u=[];try{for(l=0;l<i.length;l+=1)o.match(i[l],t)&&(s||0===h)&&(h+=1,r=o.modify(i[l],e),d.timestampData&&(r.updatedAt=new Date),u.push({oldDoc:i[l],newDoc:r}))}catch(t){return a(t)}try{d.updateIndexes(u)}catch(t){return a(t)}var f=c.pluck(u,"newDoc");d.persistence.persistNewState(f,function(t){if(t)return a(t);if(n.returnUpdatedDocs){var e=[];return f.forEach(function(t){e.push(o.deepCopy(t))}),a(null,h,e)}return a(null,h)})}])},d.prototype.update=function(){this.executor.push({this:this,fn:this._update,arguments:arguments})},d.prototype._remove=function(t,e,n){var r,i,a=this,s=0,u=[],c=this.getCandidates(t);"function"==typeof e&&(n=e,e={}),r=n||function(){},i=void 0!==e.multi&&e.multi;try{c.forEach(function(e){o.match(e,t)&&(i||0===s)&&(s+=1,u.push({$$deleted:!0,_id:e._id}),a.removeFromIndexes(e))})}catch(t){return r(t)}a.persistence.persistNewState(u,function(t){return t?r(t):r(null,s)})},d.prototype.remove=function(){this.executor.push({this:this,fn:this._remove,arguments:arguments})},e.exports=d},{"./cursor":5,"./customUtils":6,"./executor":8,"./indexes":9,"./model":10,"./persistence":11,async:13,events:1,underscore:19,util:3}],8:[function(t,n,r){var o=t("__browserify_process"),i=t("async");function a(){this.buffer=[],this.ready=!1,this.queue=i.queue(function(t,n){var r,i,a=t.arguments[t.arguments.length-1],s=[];for(i=0;i<t.arguments.length;i+=1)s.push(t.arguments[i]);"function"==typeof a?(r=function(){"function"==typeof e?e(n):o.nextTick(n),a.apply(null,arguments)},s[s.length-1]=r):(r=function(){n()},s.push(r)),t.fn.apply(t.this,s)},1)}a.prototype.push=function(t,e){this.ready||e?this.queue.push(t):this.buffer.push(t)},a.prototype.processBuffer=function(){var t;for(this.ready=!0,t=0;t<this.buffer.length;t+=1)this.queue.push(this.buffer[t]);this.buffer=[]},n.exports=a},{__browserify_process:4,async:13}],9:[function(t,e,n){var r=t("binary-search-tree").AVLTree,o=t("./model"),i=t("underscore"),a=t("util");function s(t,e){return t===e}function u(t){return null===t?"$null":"string"==typeof t?"$string"+t:"boolean"==typeof t?"$boolean"+t:"number"==typeof t?"$number"+t:a.isArray(t)?"$date"+t.getTime():t}function c(t){this.fieldName=t.fieldName,this.unique=t.unique||!1,this.sparse=t.sparse||!1,this.treeOptions={unique:this.unique,compareKeys:o.compareThings,checkValueEquality:s},this.reset()}c.prototype.reset=function(t){this.tree=new r(this.treeOptions),t&&this.insert(t)},c.prototype.insert=function(t){var e,n,r,s,c;if(a.isArray(t))this.insertMultipleDocs(t);else if(void 0!==(e=o.getDotValue(t,this.fieldName))||!this.sparse)if(a.isArray(e)){for(n=i.uniq(e,u),r=0;r<n.length;r+=1)try{this.tree.insert(n[r],t)}catch(t){c=t,s=r;break}if(c){for(r=0;r<s;r+=1)this.tree.delete(n[r],t);throw c}}else this.tree.insert(e,t)},c.prototype.insertMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)try{this.insert(t[e])}catch(t){n=t,r=e;break}if(n){for(e=0;e<r;e+=1)this.remove(t[e]);throw n}},c.prototype.remove=function(t){var e,n=this;a.isArray(t)?t.forEach(function(t){n.remove(t)}):void 0===(e=o.getDotValue(t,this.fieldName))&&this.sparse||(a.isArray(e)?i.uniq(e,u).forEach(function(e){n.tree.delete(e,t)}):this.tree.delete(e,t))},c.prototype.update=function(t,e){if(a.isArray(t))this.updateMultipleDocs(t);else{this.remove(t);try{this.insert(e)}catch(e){throw this.insert(t),e}}},c.prototype.updateMultipleDocs=function(t){var e,n,r;for(e=0;e<t.length;e+=1)this.remove(t[e].oldDoc);for(e=0;e<t.length;e+=1)try{this.insert(t[e].newDoc)}catch(t){r=t,n=e;break}if(r){for(e=0;e<n;e+=1)this.remove(t[e].newDoc);for(e=0;e<t.length;e+=1)this.insert(t[e].oldDoc);throw r}},c.prototype.revertUpdate=function(t,e){var n=[];a.isArray(t)?(t.forEach(function(t){n.push({oldDoc:t.newDoc,newDoc:t.oldDoc})}),this.update(n)):this.update(e,t)},c.prototype.getMatching=function(t){var e=this;if(a.isArray(t)){var n={},r=[];return t.forEach(function(t){e.getMatching(t).forEach(function(t){n[t._id]=t})}),Object.keys(n).forEach(function(t){r.push(n[t])}),r}return e.tree.search(t)},c.prototype.getBetweenBounds=function(t){return this.tree.betweenBounds(t)},c.prototype.getAll=function(){var t=[];return this.tree.executeOnEveryNode(function(e){var n;for(n=0;n<e.data.length;n+=1)t.push(e.data[n])}),t},e.exports=c},{"./model":10,"binary-search-tree":14,underscore:19,util:3}],10:[function(t,e,n){var r=t("util"),o=t("underscore"),i={},a={},s={},u={},c={};function l(t,e){if("number"==typeof t&&(t=t.toString()),!("$"!==t[0]||"$$date"===t&&"number"==typeof e||"$$deleted"===t&&!0===e||"$$indexCreated"===t||"$$indexRemoved"===t))throw new Error("Field names cannot begin with the $ character");if(-1!==t.indexOf("."))throw new Error("Field names cannot contain a .")}function f(t){r.isArray(t)&&t.forEach(function(t){f(t)}),"object"==typeof t&&null!==t&&Object.keys(t).forEach(function(e){l(e,t[e]),f(t[e])})}function d(t,e){var n;return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||r.isDate(t)?t:r.isArray(t)?(n=[],t.forEach(function(t){n.push(d(t,e))}),n):"object"==typeof t?(n={},Object.keys(t).forEach(function(r){(!e||"$"!==r[0]&&-1===r.indexOf("."))&&(n[r]=d(t[r],e))}),n):void 0}function h(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t||null===t||r.isDate(t)||r.isArray(t)}function p(t,e){return t<e?-1:t>e?1:0}function g(t,e){var n,r;for(n=0;n<Math.min(t.length,e.length);n+=1)if(0!==(r=v(t[n],e[n])))return r;return p(t.length,e.length)}function v(t,e,n){var o,i,a,s,u=n||p;if(void 0===t)return void 0===e?0:-1;if(void 0===e)return void 0===t?0:1;if(null===t)return null===e?0:-1;if(null===e)return null===t?0:1;if("number"==typeof t)return"number"==typeof e?p(t,e):-1;if("number"==typeof e)return"number"==typeof t?p(t,e):1;if("string"==typeof t)return"string"==typeof e?u(t,e):-1;if("string"==typeof e)return"string"==typeof t?u(t,e):1;if("boolean"==typeof t)return"boolean"==typeof e?p(t,e):-1;if("boolean"==typeof e)return"boolean"==typeof t?p(t,e):1;if(r.isDate(t))return r.isDate(e)?p(t.getTime(),e.getTime()):-1;if(r.isDate(e))return r.isDate(t)?p(t.getTime(),e.getTime()):1;if(r.isArray(t))return r.isArray(e)?g(t,e):-1;if(r.isArray(e))return r.isArray(t)?g(t,e):1;for(o=Object.keys(t).sort(),i=Object.keys(e).sort(),s=0;s<Math.min(o.length,i.length);s+=1)if(0!==(a=v(t[o[s]],e[i[s]])))return a;return p(o.length,i.length)}function y(t,e){var n,o,i="string"==typeof e?e.split("."):e;if(t){if(0===i.length)return t;if(1===i.length)return t[i[0]];if(r.isArray(t[i[0]])){if("number"==typeof(n=parseInt(i[1],10))&&!isNaN(n))return y(t[i[0]][n],i.slice(2));for(o=new Array,n=0;n<t[i[0]].length;n+=1)o.push(y(t[i[0]][n],i.slice(1)));return o}return y(t[i[0]],i.slice(1))}}function m(t,e){var n,o,i;if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return t===e;if(r.isDate(t)||r.isDate(e))return r.isDate(t)&&r.isDate(e)&&t.getTime()===e.getTime();if((!r.isArray(t)||!r.isArray(e))&&(r.isArray(t)||r.isArray(e))||void 0===t||void 0===e)return!1;try{n=Object.keys(t),o=Object.keys(e)}catch(t){return!1}if(n.length!==o.length)return!1;for(i=0;i<n.length;i+=1){if(-1===o.indexOf(n[i]))return!1;if(!m(t[n[i]],e[n[i]]))return!1}return!0}function b(t,e){return!("string"!=typeof t&&"number"!=typeof t&&!r.isDate(t)&&"string"!=typeof e&&"number"!=typeof e&&!r.isDate(e))&&typeof t==typeof e}function w(t,e){var n,r,o,i;if(h(t)||h(e))return _({needAKey:t},"needAKey",e);for(n=Object.keys(e),i=0;i<n.length;i+=1)if(o=e[r=n[i]],"$"===r[0]){if(!u[r])throw new Error("Unknown logical operator "+r);if(!u[r](t,o))return!1}else if(!_(t,r,o))return!1;return!0}function _(t,e,n,i){var a,u,l,f,d=y(t,e);if(r.isArray(d)&&!i){if(r.isArray(n))return _(t,e,n,!0);if(null!==n&&"object"==typeof n&&!r.isRegExp(n))for(u=Object.keys(n),a=0;a<u.length;a+=1)if(c[u[a]])return _(t,e,n,!0);for(a=0;a<d.length;a+=1)if(_({k:d[a]},"k",n))return!0;return!1}if(null!==n&&"object"==typeof n&&!r.isRegExp(n)&&!r.isArray(n)){if(u=Object.keys(n),l=o.map(u,function(t){return t[0]}),0!==(f=o.filter(l,function(t){return"$"===t})).length&&f.length!==l.length)throw new Error("You cannot mix operators and normal fields");if(f.length>0){for(a=0;a<u.length;a+=1){if(!s[u[a]])throw new Error("Unknown comparison function "+u[a]);if(!s[u[a]](d,n[u[a]]))return!1}return!0}}return r.isRegExp(n)?s.$regex(d,n):!!m(d,n)}a.$set=function(t,e,n){t[e]=n},a.$unset=function(t,e,n){delete t[e]},a.$push=function(t,e,n){if(t.hasOwnProperty(e)||(t[e]=[]),!r.isArray(t[e]))throw new Error("Can't $push an element on non-array values");if(null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>1)throw new Error("Can't use another field in conjunction with $each");if(!r.isArray(n.$each))throw new Error("$each requires an array value");n.$each.forEach(function(n){t[e].push(n)})}else t[e].push(n)},a.$addToSet=function(t,e,n){var o=!0;if(t.hasOwnProperty(e)||(t[e]=[]),!r.isArray(t[e]))throw new Error("Can't $addToSet an element on non-array values");if(null!==n&&"object"==typeof n&&n.$each){if(Object.keys(n).length>1)throw new Error("Can't use another field in conjunction with $each");if(!r.isArray(n.$each))throw new Error("$each requires an array value");n.$each.forEach(function(n){a.$addToSet(t,e,n)})}else t[e].forEach(function(t){0===v(t,n)&&(o=!1)}),o&&t[e].push(n)},a.$pop=function(t,e,n){if(!r.isArray(t[e]))throw new Error("Can't $pop an element from non-array values");if("number"!=typeof n)throw new Error(n+" isn't an integer, can't use it with $pop");0!==n&&(t[e]=n>0?t[e].slice(0,t[e].length-1):t[e].slice(1))},a.$pull=function(t,e,n){var o,i;if(!r.isArray(t[e]))throw new Error("Can't $pull an element from non-array values");for(i=(o=t[e]).length-1;i>=0;i-=1)w(o[i],n)&&o.splice(i,1)},a.$inc=function(t,e,n){if("number"!=typeof n)throw new Error(n+" must be a number");if("number"!=typeof t[e]){if(o.has(t,e))throw new Error("Don't use the $inc modifier on non-number fields");t[e]=n}else t[e]+=n},Object.keys(a).forEach(function(t){i[t]=function(t){return function(e,n,r){var o="string"==typeof n?n.split("."):n;1===o.length?a[t](e,n,r):(e[o[0]]=e[o[0]]||{},i[t](e[o[0]],o.slice(1),r))}}(t)}),s.$lt=function(t,e){return b(t,e)&&t<e},s.$lte=function(t,e){return b(t,e)&&t<=e},s.$gt=function(t,e){return b(t,e)&&t>e},s.$gte=function(t,e){return b(t,e)&&t>=e},s.$ne=function(t,e){return void 0===t||!m(t,e)},s.$in=function(t,e){var n;if(!r.isArray(e))throw new Error("$in operator called with a non-array");for(n=0;n<e.length;n+=1)if(m(t,e[n]))return!0;return!1},s.$nin=function(t,e){if(!r.isArray(e))throw new Error("$nin operator called with a non-array");return!s.$in(t,e)},s.$regex=function(t,e){if(!r.isRegExp(e))throw new Error("$regex operator called with non regular expression");return"string"==typeof t&&e.test(t)},s.$exists=function(t,e){return e=!(!e&&""!==e),void 0===t?!e:e},s.$size=function(t,e){if(!r.isArray(t))return!1;if(e%1!=0)throw new Error("$size operator called without an integer");return t.length==e},c.$size=!0,u.$or=function(t,e){var n;if(!r.isArray(e))throw new Error("$or operator used without an array");for(n=0;n<e.length;n+=1)if(w(t,e[n]))return!0;return!1},u.$and=function(t,e){var n;if(!r.isArray(e))throw new Error("$and operator used without an array");for(n=0;n<e.length;n+=1)if(!w(t,e[n]))return!1;return!0},u.$not=function(t,e){return!w(t,e)},u.$where=function(t,e){var n;if(!o.isFunction(e))throw new Error("$where operator used without a function");if(n=e.call(t),!o.isBoolean(n))throw new Error("$where function must return boolean");return n},e.exports.serialize=function(t){return JSON.stringify(t,function(t,e){if(l(t,e),void 0!==e)return null===e?null:"function"==typeof this[t].getTime?{$$date:this[t].getTime()}:e})},e.exports.deserialize=function(t){return JSON.parse(t,function(t,e){return"$$date"===t?new Date(e):"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e?e:e&&e.$$date?e.$$date:e})},e.exports.deepCopy=d,e.exports.checkObject=f,e.exports.isPrimitiveType=h,e.exports.modify=function(t,e){var n,r,a=Object.keys(e),s=o.map(a,function(t){return t[0]}),u=o.filter(s,function(t){return"$"===t});if(-1!==a.indexOf("_id")&&e._id!==t._id)throw new Error("You cannot change a document's _id");if(0!==u.length&&u.length!==s.length)throw new Error("You cannot mix modifiers and normal fields");if(0===u.length?(n=d(e))._id=t._id:(r=o.uniq(a),n=d(t),r.forEach(function(t){if(!i[t])throw new Error("Unknown modifier "+t);if("object"!=typeof e[t])throw new Error("Modifier "+t+"'s argument must be an object");Object.keys(e[t]).forEach(function(r){i[t](n,r,e[t][r])})})),f(n),t._id!==n._id)throw new Error("You can't change a document's _id");return n},e.exports.getDotValue=y,e.exports.match=w,e.exports.areThingsEqual=m,e.exports.compareThings=v},{underscore:19,util:3}],11:[function(t,e,n){var r=t("__browserify_process"),o=t("./storage"),i=t("path"),a=t("./model"),s=t("async"),u=t("./customUtils"),c=t("./indexes");function l(t){var e,n,r;if(this.db=t.db,this.inMemoryOnly=this.db.inMemoryOnly,this.filename=this.db.filename,this.corruptAlertThreshold=void 0!==t.corruptAlertThreshold?t.corruptAlertThreshold:.1,!this.inMemoryOnly&&this.filename&&"~"===this.filename.charAt(this.filename.length-1))throw new Error("The datafile name can't end with a ~, which is reserved for crash safe backup files");if(t.afterSerialization&&!t.beforeDeserialization)throw new Error("Serialization hook defined but deserialization hook undefined, cautiously refusing to start NeDB to prevent dataloss");if(!t.afterSerialization&&t.beforeDeserialization)throw new Error("Serialization hook undefined but deserialization hook defined, cautiously refusing to start NeDB to prevent dataloss");for(this.afterSerialization=t.afterSerialization||function(t){return t},this.beforeDeserialization=t.beforeDeserialization||function(t){return t},e=1;e<30;e+=1)for(n=0;n<10;n+=1)if(r=u.uid(e),this.beforeDeserialization(this.afterSerialization(r))!==r)throw new Error("beforeDeserialization is not the reverse of afterSerialization, cautiously refusing to start NeDB to prevent dataloss");this.filename&&t.nodeWebkitAppName&&(console.log("=================================================================="),console.log("WARNING: The nodeWebkitAppName option is deprecated"),console.log("To get the path to the directory where Node Webkit stores the data"),console.log("for your app, use the internal nw.gui module like this"),console.log("require('nw.gui').App.dataPath"),console.log("See https://github.com/rogerwang/node-webkit/issues/500"),console.log("=================================================================="),this.filename=l.getNWAppFilename(t.nodeWebkitAppName,this.filename))}l.ensureDirectoryExists=function(t,e){var n=e||function(){};o.mkdirp(t,function(t){return n(t)})},l.getNWAppFilename=function(t,e){var n;switch(r.platform){case"win32":case"win64":if(!(n=r.env.LOCALAPPDATA||r.env.APPDATA))throw new Error("Couldn't find the base application data folder");n=i.join(n,t);break;case"darwin":if(!(n=r.env.HOME))throw new Error("Couldn't find the base application data directory");n=i.join(n,"Library","Application Support",t);break;case"linux":if(!(n=r.env.HOME))throw new Error("Couldn't find the base application data directory");n=i.join(n,".config",t);break;default:throw new Error("Can't use the Node Webkit relative path for platform "+r.platform)}return i.join(n,"nedb-data",e)},l.prototype.persistCachedDatabase=function(t){var e=t||function(){},n="",r=this;if(this.inMemoryOnly)return e(null);this.db.getAllData().forEach(function(t){n+=r.afterSerialization(a.serialize(t))+"\n"}),Object.keys(this.db.indexes).forEach(function(t){"_id"!=t&&(n+=r.afterSerialization(a.serialize({$$indexCreated:{fieldName:t,unique:r.db.indexes[t].unique,sparse:r.db.indexes[t].sparse}}))+"\n")}),o.crashSafeWriteFile(this.filename,n,function(t){return t?e(t):(r.db.emit("compaction.done"),e(null))})},l.prototype.compactDatafile=function(){this.db.executor.push({this:this,fn:this.persistCachedDatabase,arguments:[]})},l.prototype.setAutocompactionInterval=function(t){var e=this,n=Math.max(t||0,5e3);this.stopAutocompaction(),this.autocompactionIntervalId=setInterval(function(){e.compactDatafile()},n)},l.prototype.stopAutocompaction=function(){this.autocompactionIntervalId&&clearInterval(this.autocompactionIntervalId)},l.prototype.persistNewState=function(t,e){var n=this,r="",i=e||function(){};return n.inMemoryOnly?i(null):(t.forEach(function(t){r+=n.afterSerialization(a.serialize(t))+"\n"}),0===r.length?i(null):void o.appendFile(n.filename,r,"utf8",function(t){return i(t)}))},l.prototype.treatRawData=function(t){var e,n=t.split("\n"),r={},o=[],i={},s=-1;for(e=0;e<n.length;e+=1){var u;try{(u=a.deserialize(this.beforeDeserialization(n[e])))._id?!0===u.$$deleted?delete r[u._id]:r[u._id]=u:u.$$indexCreated&&void 0!=u.$$indexCreated.fieldName?i[u.$$indexCreated.fieldName]=u.$$indexCreated:"string"==typeof u.$$indexRemoved&&delete i[u.$$indexRemoved]}catch(t){s+=1}}if(n.length>0&&s/n.length>this.corruptAlertThreshold)throw new Error("More than "+Math.floor(100*this.corruptAlertThreshold)+"% of the data file is corrupt, the wrong beforeDeserialization hook may be used. Cautiously refusing to start NeDB to prevent dataloss");return Object.keys(r).forEach(function(t){o.push(r[t])}),{data:o,indexes:i}},l.prototype.loadDatabase=function(t){var e=t||function(){},n=this;if(n.db.resetIndexes(),n.inMemoryOnly)return e(null);s.waterfall([function(t){l.ensureDirectoryExists(i.dirname(n.filename),function(e){o.ensureDatafileIntegrity(n.filename,function(e){o.readFile(n.filename,"utf8",function(e,r){if(e)return t(e);try{var o=n.treatRawData(r)}catch(e){return t(e)}Object.keys(o.indexes).forEach(function(t){n.db.indexes[t]=new c(o.indexes[t])});try{n.db.resetIndexes(o.data)}catch(e){return n.db.resetIndexes(),t(e)}n.db.persistence.persistCachedDatabase(t)})})})}],function(t){return t?e(t):(n.db.executor.processBuffer(),e(null))})},e.exports=l},{"./customUtils":6,"./indexes":9,"./model":10,"./storage":12,__browserify_process:4,async:13,path:2}],12:[function(t,e,n){var r=t("localforage");function o(t,e,n,o){"function"==typeof n&&(o=n),r.setItem(t,e,function(){return o()})}r.config({name:"NeDB",storeName:"nedbdata"}),e.exports.exists=function(t,e){r.getItem(t,function(t,n){return e(null!==n)})},e.exports.rename=function(t,e,n){r.getItem(t,function(o,i){null===i?r.removeItem(e,function(){return n()}):r.setItem(e,i,function(){r.removeItem(t,function(){return n()})})})},e.exports.writeFile=o,e.exports.crashSafeWriteFile=o,e.exports.appendFile=function(t,e,n,o){"function"==typeof n&&(o=n),r.getItem(t,function(n,i){i=i||"",i+=e,r.setItem(t,i,function(){return o()})})},e.exports.readFile=function(t,e,n){"function"==typeof e&&(n=e),r.getItem(t,function(t,e){return n(null,e||"")})},e.exports.unlink=function(t,e){r.removeItem(t,function(){return e()})},e.exports.mkdirp=function(t,e){return e()},e.exports.ensureDatafileIntegrity=function(t,e){return e(null)}},{localforage:18}],13:[function(t,n,r){var o=t("__browserify_process");!function(){var t,r,i={};function a(e){var n=!1;return function(){if(n)throw new Error("Callback was already called.");n=!0,e.apply(t,arguments)}}null!=(t=this)&&(r=t.async),i.noConflict=function(){return t.async=r,i};var s=function(t,e){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n+=1)e(t[n],n,t)},u=function(t,e){if(t.map)return t.map(e);var n=[];return s(t,function(t,r,o){n.push(e(t,r,o))}),n},c=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};void 0!==o&&o.nextTick?(i.nextTick=o.nextTick,i.setImmediate=void 0!==e?function(t){e(t)}:i.nextTick):"function"==typeof e?(i.nextTick=function(t){e(t)},i.setImmediate=i.nextTick):(i.nextTick=function(t){setTimeout(t,0)},i.setImmediate=i.nextTick),i.each=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0;s(t,function(o){e(o,a(function(e){e?(n(e),n=function(){}):(r+=1)>=t.length&&n(null)}))})},i.forEach=i.each,i.eachSeries=function(t,e,n){if(n=n||function(){},!t.length)return n();var r=0,o=function(){e(t[r],function(e){e?(n(e),n=function(){}):(r+=1)>=t.length?n(null):o()})};o()},i.forEachSeries=i.eachSeries,i.eachLimit=function(t,e,n,r){l(e).apply(null,[t,n,r])},i.forEachLimit=i.eachLimit;var l=function(t){return function(e,n,r){if(r=r||function(){},!e.length||t<=0)return r();var o=0,i=0,a=0;!function s(){if(o>=e.length)return r();for(;a<t&&i<e.length;)a+=1,n(e[(i+=1)-1],function(t){t?(r(t),r=function(){}):(a-=1,(o+=1)>=e.length?r():s())})}()}},f=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[i.each].concat(e))}},d=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[i.eachSeries].concat(e))}},h=function(t,e,n,r){var o=[];t(e=u(e,function(t,e){return{index:e,value:t}}),function(t,e){n(t.value,function(n,r){o[t.index]=r,e(n)})},function(t){r(t,o)})};i.map=f(h),i.mapSeries=d(h),i.mapLimit=function(t,e,n,r){return p(e)(t,n,r)};var p=function(t){return function(t,e){return function(){var n=Array.prototype.slice.call(arguments);return e.apply(null,[l(t)].concat(n))}}(t,h)};i.reduce=function(t,e,n,r){i.eachSeries(t,function(t,r){n(e,t,function(t,n){e=n,r(t)})},function(t){r(t,e)})},i.inject=i.reduce,i.foldl=i.reduce,i.reduceRight=function(t,e,n,r){var o=u(t,function(t){return t}).reverse();i.reduce(o,e,n,r)},i.foldr=i.reduceRight;var g=function(t,e,n,r){var o=[];t(e=u(e,function(t,e){return{index:e,value:t}}),function(t,e){n(t.value,function(n){n&&o.push(t),e()})},function(t){r(u(o.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};i.filter=f(g),i.filterSeries=d(g),i.select=i.filter,i.selectSeries=i.filterSeries;var v=function(t,e,n,r){var o=[];t(e=u(e,function(t,e){return{index:e,value:t}}),function(t,e){n(t.value,function(n){n||o.push(t),e()})},function(t){r(u(o.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};i.reject=f(v),i.rejectSeries=d(v);var y=function(t,e,n,r){t(e,function(t,e){n(t,function(n){n?(r(t),r=function(){}):e()})},function(t){r()})};i.detect=f(y),i.detectSeries=d(y),i.some=function(t,e,n){i.each(t,function(t,r){e(t,function(t){t&&(n(!0),n=function(){}),r()})},function(t){n(!1)})},i.any=i.some,i.every=function(t,e,n){i.each(t,function(t,r){e(t,function(t){t||(n(!1),n=function(){}),r()})},function(t){n(!0)})},i.all=i.every,i.sortBy=function(t,e,n){i.map(t,function(t,n){e(t,function(e,r){e?n(e):n(null,{value:t,criteria:r})})},function(t,e){if(t)return n(t);n(null,u(e.sort(function(t,e){var n=t.criteria,r=e.criteria;return n<r?-1:n>r?1:0}),function(t){return t.value}))})},i.auto=function(t,e){e=e||function(){};var n=c(t);if(!n.length)return e(null);var r={},o=[],a=function(t){o.unshift(t)},u=function(){s(o.slice(0),function(t){t()})};a(function(){c(r).length===n.length&&(e(null,r),e=function(){})}),s(n,function(n){var l=t[n]instanceof Function?[t[n]]:t[n],f=function(t){var o=Array.prototype.slice.call(arguments,1);if(o.length<=1&&(o=o[0]),t){var a={};s(c(r),function(t){a[t]=r[t]}),a[n]=o,e(t,a),e=function(){}}else r[n]=o,i.setImmediate(u)},d=l.slice(0,Math.abs(l.length-1))||[],h=function(){return e=function(t,e){return t&&r.hasOwnProperty(e)},o=!0,((t=d).reduce?t.reduce(e,o):(s(t,function(t,n,r){o=e(o,t,n,r)}),o))&&!r.hasOwnProperty(n);var t,e,o};if(h())l[l.length-1](f,r);else{var p=function(){h()&&(!function(t){for(var e=0;e<o.length;e+=1)if(o[e]===t)return void o.splice(e,1)}(p),l[l.length-1](f,r))};a(p)}})},i.waterfall=function(t,e){if(e=e||function(){},t.constructor!==Array){var n=new Error("First argument to waterfall must be an array of functions");return e(n)}if(!t.length)return e();var r=function(t){return function(n){if(n)e.apply(null,arguments),e=function(){};else{var o=Array.prototype.slice.call(arguments,1),a=t.next();a?o.push(r(a)):o.push(e),i.setImmediate(function(){t.apply(null,o)})}}};r(i.iterator(t))()};var m=function(t,e,n){if(n=n||function(){},e.constructor===Array)t.map(e,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},n);else{var r={};t.each(c(e),function(t,n){e[t](function(e){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),r[t]=o,n(e)})},function(t){n(t,r)})}};i.parallel=function(t,e){m({map:i.map,each:i.each},t,e)},i.parallelLimit=function(t,e,n){m({map:p(e),each:l(e)},t,n)},i.series=function(t,e){if(e=e||function(){},t.constructor===Array)i.mapSeries(t,function(t,e){t&&t(function(t){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),e.call(null,t,n)})},e);else{var n={};i.eachSeries(c(t),function(e,r){t[e](function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]),n[e]=o,r(t)})},function(t){e(t,n)})}},i.iterator=function(t){var e=function(n){var r=function(){return t.length&&t[n].apply(null,arguments),r.next()};return r.next=function(){return n<t.length-1?e(n+1):null},r};return e(0)},i.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var b=function(t,e,n,r){var o=[];t(e,function(t,e){n(t,function(t,n){o=o.concat(n||[]),e(t)})},function(t){r(t,o)})};i.concat=f(b),i.concatSeries=d(b),i.whilst=function(t,e,n){t()?e(function(r){if(r)return n(r);i.whilst(t,e,n)}):n()},i.doWhilst=function(t,e,n){t(function(r){if(r)return n(r);e()?i.doWhilst(t,e,n):n()})},i.until=function(t,e,n){t()?n():e(function(r){if(r)return n(r);i.until(t,e,n)})},i.doUntil=function(t,e,n){t(function(r){if(r)return n(r);e()?n():i.doUntil(t,e,n)})},i.queue=function(t,e){function n(t,n,r,o){n.constructor!==Array&&(n=[n]),s(n,function(n){var a={data:n,callback:"function"==typeof o?o:null};r?t.tasks.unshift(a):t.tasks.push(a),t.saturated&&t.tasks.length===e&&t.saturated(),i.setImmediate(t.process)})}void 0===e&&(e=1);var r=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,push:function(t,e){n(o,t,!1,e)},unshift:function(t,e){n(o,t,!0,e)},process:function(){if(r<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),r+=1;var n=a(function(){r-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+r===0&&o.drain(),o.process()});t(e.data,n)}},length:function(){return o.tasks.length},running:function(){return r}};return o},i.cargo=function(t,e){var n=!1,r=[],o={tasks:r,payload:e,saturated:null,empty:null,drain:null,push:function(t,n){t.constructor!==Array&&(t=[t]),s(t,function(t){r.push({data:t,callback:"function"==typeof n?n:null}),o.saturated&&r.length===e&&o.saturated()}),i.setImmediate(o.process)},process:function i(){if(!n)if(0!==r.length){var a="number"==typeof e?r.splice(0,e):r.splice(0),c=u(a,function(t){return t.data});o.empty&&o.empty(),n=!0,t(c,function(){n=!1;var t=arguments;s(a,function(e){e.callback&&e.callback.apply(null,t)}),i()})}else o.drain&&o.drain()},length:function(){return r.length},running:function(){return n}};return o};var w=function(t){return function(e){var n=Array.prototype.slice.call(arguments,1);e.apply(null,n.concat([function(e){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&s(n,function(e){console[t](e)}))}]))}};i.log=w("log"),i.dir=w("dir"),i.memoize=function(t,e){var n={},r={};e=e||function(t){return t};var o=function(){var o=Array.prototype.slice.call(arguments),i=o.pop(),a=e.apply(null,o);a in n?i.apply(null,n[a]):a in r?r[a].push(i):(r[a]=[i],t.apply(null,o.concat([function(){n[a]=arguments;var t=r[a];delete r[a];for(var e=0,o=t.length;e<o;e++)t[e].apply(null,arguments)}])))};return o.memo=n,o.unmemoized=t,o},i.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},i.times=function(t,e,n){for(var r=[],o=0;o<t;o++)r.push(o);return i.map(r,e,n)},i.timesSeries=function(t,e,n){for(var r=[],o=0;o<t;o++)r.push(o);return i.mapSeries(r,e,n)},i.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var e=this,n=Array.prototype.slice.call(arguments),r=n.pop();i.reduce(t,n,function(t,n,r){n.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);r(t,e)}]))},function(t,n){r.apply(e,[t].concat(n))})}};var _=function(t,e){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),o=r.pop();return t(e,function(t,e){t.apply(n,r.concat([e]))},o)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};i.applyEach=f(_),i.applyEachSeries=d(_),i.forever=function(t,e){!function n(r){if(r){if(e)return e(r);throw r}t(n)}()},void 0!==n&&n.exports?n.exports=i:t.async=i}()},{__browserify_process:4}],14:[function(t,e,n){e.exports.BinarySearchTree=t("./lib/bst"),e.exports.AVLTree=t("./lib/avltree")},{"./lib/avltree":15,"./lib/bst":16}],15:[function(t,e,n){var r=t("./bst"),o=t("./customUtils"),i=t("util");t("underscore");function a(t){this.tree=new s(t)}function s(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||o.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||o.defaultCheckValueEquality}i.inherits(s,r),a._AVLTree=s,s.prototype.checkHeightCorrect=function(){var t,e;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(t=this.left?this.left.height:0,e=this.right?this.right.height:0,this.height!==1+Math.max(t,e))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},s.prototype.balanceFactor=function(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)},s.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},s.prototype.checkIsAVLT=function(){s.super_.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},a.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},s.prototype.rightRotation=function(){var t,e,n,r,o=this,i=this.left;return i?(t=i.right,o.parent?(i.parent=o.parent,o.parent.left===o?o.parent.left=i:o.parent.right=i):i.parent=null,i.right=o,o.parent=i,o.left=t,t&&(t.parent=o),e=i.left?i.left.height:0,n=t?t.height:0,r=o.right?o.right.height:0,o.height=Math.max(n,r)+1,i.height=Math.max(e,o.height)+1,i):this},s.prototype.leftRotation=function(){var t,e,n,r,o=this,i=this.right;return i?(t=i.left,o.parent?(i.parent=o.parent,o.parent.left===o?o.parent.left=i:o.parent.right=i):i.parent=null,i.left=o,o.parent=i,o.right=t,t&&(t.parent=o),e=o.left?o.left.height:0,n=t?t.height:0,r=i.right?i.right.height:0,o.height=Math.max(e,n)+1,i.height=Math.max(r,o.height)+1,i):this},s.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},s.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},s.prototype.rebalanceAlongPath=function(t){var e,n,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(n=t.length-1;n>=0;n-=1)t[n].height=1+Math.max(t[n].left?t[n].left.height:0,t[n].right?t[n].right.height:0),t[n].balanceFactor()>1&&(e=t[n].rightTooSmall(),0===n&&(r=e)),t[n].balanceFactor()<-1&&(e=t[n].leftTooSmall(),0===n&&(r=e));return r},s.prototype.insert=function(t,e){var n=[],r=this;if(!this.hasOwnProperty("key"))return this.key=t,this.data.push(e),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,t)){if(r.unique){var o=new Error("Can't insert key "+t+", it violates the unique constraint");throw o.key=t,o.errorType="uniqueViolated",o}return r.data.push(e),this}if(n.push(r),r.compareKeys(t,r.key)<0){if(!r.left){n.push(r.createLeftChild({key:t,value:e}));break}r=r.left}else{if(!r.right){n.push(r.createRightChild({key:t,value:e}));break}r=r.right}}return this.rebalanceAlongPath(n)},a.prototype.insert=function(t,e){var n=this.tree.insert(t,e);n&&(this.tree=n)},s.prototype.delete=function(t,e){var n,r=[],o=this,i=[];if(!this.hasOwnProperty("key"))return this;for(;0!==o.compareKeys(t,o.key);)if(i.push(o),o.compareKeys(t,o.key)<0){if(!o.left)return this;o=o.left}else{if(!o.right)return this;o=o.right}if(o.data.length>1&&e)return o.data.forEach(function(t){o.checkValueEquality(t,e)||r.push(t)}),o.data=r,this;if(!o.left&&!o.right)return o===this?(delete o.key,o.data=[],delete o.height,this):(o.parent.left===o?o.parent.left=null:o.parent.right=null,this.rebalanceAlongPath(i));if(!o.left||!o.right)return n=o.left?o.left:o.right,o===this?(n.parent=null,n):(o.parent.left===o?(o.parent.left=n,n.parent=o.parent):(o.parent.right=n,n.parent=o.parent),this.rebalanceAlongPath(i));if(i.push(o),!(n=o.left).right)return o.key=n.key,o.data=n.data,o.left=n.left,n.left&&(n.left.parent=o),this.rebalanceAlongPath(i);for(;n.right;)i.push(n),n=n.right;return o.key=n.key,o.data=n.data,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(i)},a.prototype.delete=function(t,e){var n=this.tree.delete(t,e);n&&(this.tree=n)},["getNumberOfKeys","search","betweenBounds","prettyPrint","executeOnEveryNode"].forEach(function(t){a.prototype[t]=function(){return this.tree[t].apply(this.tree,arguments)}}),e.exports=a},{"./bst":16,"./customUtils":17,underscore:19,util:3}],16:[function(t,e,n){var r=t("./customUtils");function o(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.data=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||r.defaultCompareKeysFunction,this.checkValueEquality=t.checkValueEquality||r.defaultCheckValueEquality}function i(t,e){var n;for(n=0;n<e.length;n+=1)t.push(e[n])}o.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},o.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},o.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},o.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},o.prototype.checkAllNodesFullfillCondition=function(t){this.hasOwnProperty("key")&&(t(this.key,this.data),this.left&&this.left.checkAllNodesFullfillCondition(t),this.right&&this.right.checkAllNodesFullfillCondition(t))},o.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)>=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition(function(e){if(t.compareKeys(e,t.key)<=0)throw new Error("Tree with root "+t.key+" is not a binary search tree")}),this.right.checkNodeOrdering()))},o.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},o.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},o.prototype.getNumberOfKeys=function(){var t;return this.hasOwnProperty("key")?(t=1,this.left&&(t+=this.left.getNumberOfKeys()),this.right&&(t+=this.right.getNumberOfKeys()),t):0},o.prototype.createSimilar=function(t){return(t=t||{}).unique=this.unique,t.compareKeys=this.compareKeys,t.checkValueEquality=this.checkValueEquality,new this.constructor(t)},o.prototype.createLeftChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.left=e,e},o.prototype.createRightChild=function(t){var e=this.createSimilar(t);return e.parent=this,this.right=e,e},o.prototype.insert=function(t,e){if(!this.hasOwnProperty("key"))return this.key=t,void this.data.push(e);if(0!==this.compareKeys(this.key,t))this.compareKeys(t,this.key)<0?this.left?this.left.insert(t,e):this.createLeftChild({key:t,value:e}):this.right?this.right.insert(t,e):this.createRightChild({key:t,value:e});else{if(this.unique){var n=new Error("Can't insert key "+t+", it violates the unique constraint");throw n.key=t,n.errorType="uniqueViolated",n}this.data.push(e)}},o.prototype.search=function(t){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,t)?this.data:this.compareKeys(t,this.key)<0?this.left?this.left.search(t):[]:this.right?this.right.search(t):[]:[]},o.prototype.getLowerBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$gt")||t.hasOwnProperty("$gte")?t.hasOwnProperty("$gt")&&t.hasOwnProperty("$gte")?0===e.compareKeys(t.$gte,t.$gt)?function(n){return e.compareKeys(n,t.$gt)>0}:e.compareKeys(t.$gte,t.$gt)>0?function(n){return e.compareKeys(n,t.$gte)>=0}:function(n){return e.compareKeys(n,t.$gt)>0}:t.hasOwnProperty("$gt")?function(n){return e.compareKeys(n,t.$gt)>0}:function(n){return e.compareKeys(n,t.$gte)>=0}:function(){return!0}},o.prototype.getUpperBoundMatcher=function(t){var e=this;return t.hasOwnProperty("$lt")||t.hasOwnProperty("$lte")?t.hasOwnProperty("$lt")&&t.hasOwnProperty("$lte")?0===e.compareKeys(t.$lte,t.$lt)?function(n){return e.compareKeys(n,t.$lt)<0}:e.compareKeys(t.$lte,t.$lt)<0?function(n){return e.compareKeys(n,t.$lte)<=0}:function(n){return e.compareKeys(n,t.$lt)<0}:t.hasOwnProperty("$lt")?function(n){return e.compareKeys(n,t.$lt)<0}:function(n){return e.compareKeys(n,t.$lte)<=0}:function(){return!0}},o.prototype.betweenBounds=function(t,e,n){var r=[];return this.hasOwnProperty("key")?(e=e||this.getLowerBoundMatcher(t),n=n||this.getUpperBoundMatcher(t),e(this.key)&&this.left&&i(r,this.left.betweenBounds(t,e,n)),e(this.key)&&n(this.key)&&i(r,this.data),n(this.key)&&this.right&&i(r,this.right.betweenBounds(t,e,n)),r):[]},o.prototype.deleteIfLeaf=function(){return!this.left&&!this.right&&(this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.data=[],!0))},o.prototype.deleteIfOnlyOneChild=function(){var t;return this.left&&!this.right&&(t=this.left),!this.left&&this.right&&(t=this.right),!!t&&(this.parent?(this.parent.left===this?(this.parent.left=t,t.parent=this.parent):(this.parent.right=t,t.parent=this.parent),!0):(this.key=t.key,this.data=t.data,this.left=null,t.left&&(this.left=t.left,t.left.parent=this),this.right=null,t.right&&(this.right=t.right,t.right.parent=this),!0))},o.prototype.delete=function(t,e){var n,r=[],o=this;if(this.hasOwnProperty("key"))if(this.compareKeys(t,this.key)<0)this.left&&this.left.delete(t,e);else if(this.compareKeys(t,this.key)>0)this.right&&this.right.delete(t,e);else if(0!==!this.compareKeys(t,this.key))return this.data.length>1&&void 0!==e?(this.data.forEach(function(t){o.checkValueEquality(t,e)||r.push(t)}),void(o.data=r)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(n=this.left.getMaxKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.left=n.left,n.left&&(n.left.parent=n.parent)):(n.parent.right=n.left,n.left&&(n.left.parent=n.parent))):(n=this.right.getMinKeyDescendant(),this.key=n.key,this.data=n.data,this===n.parent?(this.right=n.right,n.right&&(n.right.parent=n.parent)):(n.parent.left=n.right,n.right&&(n.right.parent=n.parent)))))},o.prototype.executeOnEveryNode=function(t){this.left&&this.left.executeOnEveryNode(t),t(this),this.right&&this.right.executeOnEveryNode(t)},o.prototype.prettyPrint=function(t,e){e=e||"",console.log(e+"* "+this.key),t&&console.log(e+"* "+this.data),(this.left||this.right)&&(this.left?this.left.prettyPrint(t,e+"  "):console.log(e+"  *"),this.right?this.right.prettyPrint(t,e+"  "):console.log(e+"  *"))},e.exports=o},{"./customUtils":17}],17:[function(t,e,n){e.exports.getRandomArray=function t(e){var n,r;return 0===e?[]:1===e?[0]:(n=t(e-1),r=Math.floor(Math.random()*e),n.splice(r,0,e-1),n)},e.exports.defaultCompareKeysFunction=function(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;var n=new Error("Couldn't compare elements");throw n.a=t,n.b=e,n},e.exports.defaultCheckValueEquality=function(t,e){return t===e}},{}],18:[function(t,e,n){var r,o,i=t("__browserify_process"),a=self;
/*!
    localForage -- Offline Storage, Improved
    Version 1.3.0
    https://mozilla.github.io/localForage
    (c) 2013-2015 Mozilla, Apache License 2.0
*/
/*!
    localForage -- Offline Storage, Improved
    Version 1.3.0
    https://mozilla.github.io/localForage
    (c) 2013-2015 Mozilla, Apache License 2.0
*/
!function(){var t,e,n,r,o;r={},o={},n=e=function(t){if(n._eak_seen=r,o[t])return o[t];if(o[t]={},!r[t])throw new Error("Could not find module "+t);for(var i,a=r[t],s=a.deps,u=a.callback,c=[],l=0,f=s.length;l<f;l++)"exports"===s[l]?c.push(i={}):c.push(e(h(s[l])));var d=u.apply(this,c);return o[t]=i||d;function h(e){if("."!==e.charAt(0))return e;for(var n=e.split("/"),r=t.split("/").slice(0,-1),o=0,i=n.length;o<i;o++){var a=n[o];if(".."===a)r.pop();else{if("."===a)continue;r.push(a)}}return r.join("/")}},(t=function(t,e,n){r[t]={deps:e,callback:n}})("promise/all",["./utils","exports"],function(t,e){"use strict";var n=t.isArray,r=t.isFunction;e.all=function(t){if(!n(t))throw new TypeError("You must pass an array to all.");return new this(function(e,n){var o,i=[],a=t.length;function s(t){return function(e){u(t,e)}}function u(t,n){i[t]=n,0==--a&&e(i)}0===a&&e([]);for(var c=0;c<t.length;c++)(o=t[c])&&r(o.then)?o.then(s(c),n):u(c,o)})}}),t("promise/asap",["exports"],function(t){"use strict";var e="undefined"!=typeof window?window:{},n=e.MutationObserver||e.WebKitMutationObserver,r=void 0!==a?a:void 0===this?window:this;var o,s,u,c,l=[];function f(){for(var t=0;t<l.length;t++){var e=l[t];(0,e[0])(e[1])}l=[]}void 0!==i&&"[object process]"==={}.toString.call(i)?o=function(){i.nextTick(f)}:n?(s=0,u=new n(f),c=document.createTextNode(""),u.observe(c,{characterData:!0}),o=function(){c.data=s=++s%2}):o=function(){r.setTimeout(f,1)},t.asap=function(t,e){1===l.push([t,e])&&o()}}),t("promise/config",["exports"],function(t){"use strict";var e={instrument:!1};t.config=e,t.configure=function(t,n){if(2!==arguments.length)return e[t];e[t]=n}}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,n){"use strict";var r=t.Promise,o=e.isFunction;n.polyfill=function(){var t,e;"Promise"in(t=void 0!==a?a:"undefined"!=typeof window&&window.document?window:self)&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&(new t.Promise(function(t){e=t}),o(e))||(t.Promise=r)}}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,n,r,o,i,a,s){"use strict";var u=t.config,c=(t.configure,e.objectOrFunction),l=e.isFunction,f=(e.now,n.all),d=r.race,h=o.resolve,p=i.reject,g=a.asap;function v(t){if(!l(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof v))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],function(t,e){function n(t){A(e,t)}try{t(function(t){k(e,t)},n)}catch(t){n(t)}}(t,this)}function y(t,e,n,r){var o,i,a,s,u=l(n);if(u)try{o=n(r),a=!0}catch(t){s=!0,i=t}else o=r,a=!0;E(e,o)||(u&&a?k(e,o):s?A(e,i):t===w?k(e,o):t===_&&A(e,o))}u.async=g;var m=void 0,b=0,w=1,_=2;function x(t,e){for(var n=t._subscribers,r=t._detail,o=0;o<n.length;o+=3)y(e,n[o],n[o+e],r);t._subscribers=null}function E(t,e){var n,r=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(c(e)&&(r=e.then,l(r)))return r.call(e,function(r){if(n)return!0;n=!0,e!==r?k(t,r):S(t,r)},function(e){if(n)return!0;n=!0,A(t,e)}),!0}catch(e){return!!n||(A(t,e),!0)}return!1}function k(t,e){t===e?S(t,e):E(t,e)||S(t,e)}function S(t,e){t._state===m&&(t._state=b,t._detail=e,u.async(I,t))}function A(t,e){t._state===m&&(t._state=b,t._detail=e,u.async(j,t))}function I(t){x(t,t._state=w)}function j(t){x(t,t._state=_)}v.prototype={constructor:v,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var n=this,r=new this.constructor(function(){});if(this._state){var o=arguments;u.async(function(){y(n._state,r,o[n._state-1],n._detail)})}else!function(t,e,n,r){var o=t._subscribers,i=o.length;o[i]=e,o[i+w]=n,o[i+_]=r}(this,r,t,e);return r},catch:function(t){return this.then(null,t)}},v.all=f,v.race=d,v.resolve=h,v.reject=p,s.Promise=v}),t("promise/race",["./utils","exports"],function(t,e){"use strict";var n=t.isArray;e.race=function(t){if(!n(t))throw new TypeError("You must pass an array to race.");return new this(function(e,n){for(var r,o=0;o<t.length;o++)(r=t[o])&&"function"==typeof r.then?r.then(e,n):e(r)})}}),t("promise/reject",["exports"],function(t){"use strict";t.reject=function(t){return new this(function(e,n){n(t)})}}),t("promise/resolve",["exports"],function(t){"use strict";t.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})}}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return"function"==typeof t}var n=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=function(t){return e(t)||"object"==typeof t&&null!==t},t.isFunction=e,t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.now=n}),e("promise/polyfill").polyfill()}(),r=this,o=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=t,n.c=e,n.p="",n(0)}([function(t,e,n){"use strict";e.__esModule=!0,function(){var t,r,o,i={},a={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},s=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],u={description:"",driver:[a.INDEXEDDB,a.WEBSQL,a.LOCALSTORAGE].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},c=(t=this,r=r||t.indexedDB||t.webkitIndexedDB||t.mozIndexedDB||t.OIndexedDB||t.msIndexedDB,(o={})[a.WEBSQL]=!!t.openDatabase,o[a.INDEXEDDB]=!!function(){if(void 0!==t.openDatabase&&t.navigator&&t.navigator.userAgent&&/Safari/.test(t.navigator.userAgent)&&!/Chrome/.test(t.navigator.userAgent))return!1;try{return r&&"function"==typeof r.open&&void 0!==t.IDBKeyRange}catch(t){return!1}}(),o[a.LOCALSTORAGE]=!!function(){try{return t.localStorage&&"setItem"in t.localStorage&&t.localStorage.setItem}catch(t){return!1}}(),o),l=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function f(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function d(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(l(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}function h(t){for(var e in a)if(a.hasOwnProperty(e)&&a[e]===t)return!0;return!1}var p=new(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.INDEXEDDB=a.INDEXEDDB,this.LOCALSTORAGE=a.LOCALSTORAGE,this.WEBSQL=a.WEBSQL,this._defaultConfig=d({},u),this._config=d({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return t.prototype.config=function(t){if("object"==typeof t){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t)"storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),this._config[e]=t[e];return"driver"in t&&t.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new Promise(function(e,n){try{var r=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),a=new Error("Custom driver name already in use: "+t._driver);if(!t._driver)return void n(o);if(h(t._driver))return void n(a);for(var u=s.concat("_initStorage"),l=0;l<u.length;l++){var f=u[l];if(!f||!t[f]||"function"!=typeof t[f])return void n(o)}var d=Promise.resolve(!0);"_support"in t&&(d=t._support&&"function"==typeof t._support?t._support():Promise.resolve(!!t._support)),d.then(function(n){c[r]=n,i[r]=t,e()},n)}catch(t){n(t)}});return r.then(e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,r){var o=this,a=function(){if(h(t))switch(t){case o.INDEXEDDB:return new Promise(function(t,e){t(n(1))});case o.LOCALSTORAGE:return new Promise(function(t,e){t(n(2))});case o.WEBSQL:return new Promise(function(t,e){t(n(4))})}else if(i[t])return Promise.resolve(i[t]);return Promise.reject(new Error("Driver not found."))}();return a.then(e,r),a},t.prototype.getSerializer=function(t){var e=new Promise(function(t,e){t(n(3))});return t&&"function"==typeof t&&e.then(function(e){t(e)}),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return n.then(t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;l(t)||(t=[t]);var o=this._getSupportedDrivers(t);function i(){r._config.driver=r.driver()}var a=null!==this._driverSet?this._driverSet.catch(function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=a.then(function(){var t=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then(function(t){r._driver=t._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var o=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(function(t){return r._extend(t),i(),r._ready=r._initStorage(r._config),r._ready}).catch(n)}i();var a=new Error("No available storage method found.");return r._driverSet=Promise.reject(a),r._driverSet}()}}(o)})}).catch(function(){i();var t=new Error("No available storage method found.");return r._driverSet=Promise.reject(t),r._driverSet}),this._driverSet.then(e,n),this._driverSet},t.prototype.supports=function(t){return!!c[t]},t.prototype._extend=function(t){d(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0;t<s.length;t++)f(this,s[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.default=p}.call("undefined"!=typeof window?window:self),t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,function(){var t=this,n=n||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(n){var r,o,i="local-forage-detect-blob-support",a={_driver:"asyncStorage",_initStorage:function(e){var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];o||(o={});var a=o[r.name];a||(a={forages:[],db:null},o[r.name]=a),a.forages.push(this);var s=[];function u(){return Promise.resolve()}for(var c=0;c<a.forages.length;c++){var l=a.forages[c];l!==this&&s.push(l.ready().catch(u))}var d=a.forages.slice(0);return Promise.all(s).then(function(){return r.db=a.db,function(t){return f(t,!1)}(r)}).then(function(e){return r.db=e,function(e,n){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,i=e.version>e.db.version;if(o&&(e.version!==n&&t.console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||r){if(r){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}(r,n._defaultConfig.version)?function(t){return f(t,!0)}(r):e}).then(function(t){for(var e in r.db=a.db=t,n._dbInfo=r,d){var o=d[e];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})},iterate:function(t,e){var n=this,r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName).openCursor(),a=1;i.onsuccess=function(){var n=i.result;if(n){var r=n.value;l(r)&&(r=c(r));var o=t(r,n.key,a++);void 0!==o?e(o):n.continue()}else e()},i.onerror=function(){r(i.error)}}).catch(r)});return d(r,e),r},getItem:function(e,n){var r=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(t,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),l(e)&&(e=c(e)),t(e)},i.onerror=function(){n(i.error)}}).catch(n)});return d(o,n),o},setItem:function(e,n,o){var i=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=new Promise(function(t,o){var a;i.ready().then(function(){return a=i._dbInfo,t=a.db,"boolean"==typeof r?Promise.resolve(r):u(t).then(function(t){return r=t});var t}).then(function(t){return!t&&n instanceof Blob?(e=n,new Promise(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})):n;var e}).then(function(n){var r=a.db.transaction(a.storeName,"readwrite"),i=r.objectStore(a.storeName);null===n&&(n=void 0);var s=i.put(n,e);r.oncomplete=function(){void 0===n&&(n=null),t(n)},r.onabort=r.onerror=function(){var t=s.error?s.error:s.transaction.error;o(t)}}).catch(o)});return d(a,o),a},removeItem:function(e,n){var r=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(t,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){n(a.error)},i.onabort=function(){var t=a.error?a.error:a.transaction.error;n(t)}}).catch(n)});return d(o,n),o},clear:function(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readwrite"),i=o.objectStore(r.storeName).clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=i.error?i.error:i.transaction.error;n(t)}}).catch(n)});return d(n,t),n},length:function(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).count();o.onsuccess=function(){t(o.result)},o.onerror=function(){n(o.error)}}).catch(n)});return d(n,t),n},key:function(t,e){var n=this,r=new Promise(function(e,r){t<0?e(null):n.ready().then(function(){var o=n._dbInfo,i=!1,a=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName).openCursor();a.onsuccess=function(){var n=a.result;n?0===t?e(n.key):i?e(n.key):(i=!0,n.advance(t)):e(null)},a.onerror=function(){r(a.error)}}).catch(r)});return d(r,e),r},keys:function(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).openCursor(),i=[];o.onsuccess=function(){var e=o.result;e?(i.push(e.key),e.continue()):t(i)},o.onerror=function(){n(o.error)}}).catch(n)});return d(n,t),n}};e.default=a}function s(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(i){if("TypeError"!==i.name)throw i;for(var r=new(t.BlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder||t.WebKitBlobBuilder),o=0;o<e.length;o+=1)r.append(e[o]);return r.getBlob(n.type)}}function u(t){return new Promise(function(e,n){var r=s([""],{type:"image/png"}),o=t.transaction([i],"readwrite");o.objectStore(i).put(r,"key"),o.oncomplete=function(){var r=t.transaction([i],"readwrite").objectStore(i).get("key");r.onerror=n,r.onsuccess=function(t){var n=t.target.result,r=URL.createObjectURL(n);(function(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.withCredentials=!0,r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState)return 200===r.status?e({response:r.response,type:r.getResponseHeader("Content-Type")}):void n({status:r.status,response:r.response})},r.send()})})(r).then(function(t){e(!(!t||"image/png"!==t.type))},function(){e(!1)}).then(function(){URL.revokeObjectURL(r)})}}}).catch(function(){return!1})}function c(t){return s([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}(atob(t.data))],{type:t.type})}function l(t){return t&&t.__local_forage_encoded_blob}function f(e,r){return new Promise(function(o,a){if(e.db){if(!r)return o(e.db);e.db.close()}var s=[e.name];r&&s.push(e.version);var u=n.open.apply(n,s);r&&(u.onupgradeneeded=function(n){var r=u.result;try{r.createObjectStore(e.storeName),n.oldVersion<=1&&r.createObjectStore(i)}catch(r){if("ConstraintError"!==r.name)throw r;t.console.warn('The database "'+e.name+'" has been upgraded from version '+n.oldVersion+" to version "+n.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),u.onerror=function(){a(u.error)},u.onsuccess=function(){o(u.result)}})}function d(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}}.call("undefined"!=typeof window?window:self),t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0,function(){var t=this,r=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;r=this.localStorage}catch(t){return}function o(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var i={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var r in t)e[r]=t[r];return e.keyPrefix=e.name+"/",e.storeName!==this._defaultConfig.storeName&&(e.keyPrefix+=e.storeName+"/"),this._dbInfo=e,new Promise(function(t,e){t(n(3))}).then(function(t){return e.serializer=t,Promise.resolve()})},iterate:function(t,e){var n=this,i=n.ready().then(function(){for(var e=n._dbInfo,o=e.keyPrefix,i=o.length,a=r.length,s=1,u=0;u<a;u++){var c=r.key(u);if(0===c.indexOf(o)){var l=r.getItem(c);if(l&&(l=e.serializer.deserialize(l)),void 0!==(l=t(l,c.substring(i),s++)))return l}}});return o(i,e),i},getItem:function(e,n){var i=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=i.ready().then(function(){var t=i._dbInfo,n=r.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n});return o(a,n),a},setItem:function(e,n,i){var a=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=a.ready().then(function(){void 0===n&&(n=null);var t=n;return new Promise(function(o,i){var s=a._dbInfo;s.serializer.serialize(n,function(n,a){if(a)i(a);else try{r.setItem(s.keyPrefix+e,n),o(t)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||i(t),i(t)}})})});return o(s,i),s},removeItem:function(e,n){var i=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=i.ready().then(function(){var t=i._dbInfo;r.removeItem(t.keyPrefix+e)});return o(a,n),a},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=r.length-1;n>=0;n--){var o=r.key(n);0===o.indexOf(t)&&r.removeItem(o)}});return o(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return o(e,t),e},key:function(t,e){var n=this,i=n.ready().then(function(){var e,o=n._dbInfo;try{e=r.key(t)}catch(t){e=null}return e&&(e=e.substring(o.keyPrefix.length)),e});return o(i,e),i},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=r.length,o=[],i=0;i<n;i++)0===r.key(i).indexOf(t.keyPrefix)&&o.push(r.key(i).substring(t.keyPrefix.length));return o});return o(n,t),n}};e.default=i}.call("undefined"!=typeof window?window:self),t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="~~local_forage_type~",r=/^~~local_forage_type~([^~]+)~/,o="__lfsc__:",i=o.length,a="arbf",s="blob",u="si08",c="ui08",l="uic8",f="si16",d="si32",h="ur16",p="ui32",g="fl32",v="fl64",y=i+a.length,m=this;function b(e){var n,r,o,i,a,s=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),f=new Uint8Array(l);for(n=0;n<u;n+=4)r=t.indexOf(e[n]),o=t.indexOf(e[n+1]),i=t.indexOf(e[n+2]),a=t.indexOf(e[n+3]),f[c++]=r<<2|o>>4,f[c++]=(15&o)<<4|i>>2,f[c++]=(3&i)<<6|63&a;return l}function w(e){var n,r=new Uint8Array(e),o="";for(n=0;n<r.length;n+=3)o+=t[r[n]>>2],o+=t[(3&r[n])<<4|r[n+1]>>4],o+=t[(15&r[n+1])<<2|r[n+2]>>6],o+=t[63&r[n+2]];return r.length%3==2?o=o.substring(0,o.length-1)+"=":r.length%3==1&&(o=o.substring(0,o.length-2)+"=="),o}var _={serialize:function(t,e){var r="";if(t&&(r=t.toString()),t&&("[object ArrayBuffer]"===t.toString()||t.buffer&&"[object ArrayBuffer]"===t.buffer.toString())){var i,y=o;t instanceof ArrayBuffer?(i=t,y+=a):(i=t.buffer,"[object Int8Array]"===r?y+=u:"[object Uint8Array]"===r?y+=c:"[object Uint8ClampedArray]"===r?y+=l:"[object Int16Array]"===r?y+=f:"[object Uint16Array]"===r?y+=h:"[object Int32Array]"===r?y+=d:"[object Uint32Array]"===r?y+=p:"[object Float32Array]"===r?y+=g:"[object Float64Array]"===r?y+=v:e(new Error("Failed to get type for BinaryArray"))),e(y+w(i))}else if("[object Blob]"===r){var m=new FileReader;m.onload=function(){var r=n+t.type+"~"+w(this.result);e(o+s+r)},m.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,i)!==o)return JSON.parse(t);var e,n=t.substring(y),w=t.substring(i,y);if(w===s&&r.test(n)){var _=n.match(r);e=_[1],n=n.substring(_[0].length)}var x=b(n);switch(w){case a:return x;case s:return function(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new(m.BlobBuilder||m.MSBlobBuilder||m.MozBlobBuilder||m.WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}([x],{type:e});case u:return new Int8Array(x);case c:return new Uint8Array(x);case l:return new Uint8ClampedArray(x);case f:return new Int16Array(x);case h:return new Uint16Array(x);case d:return new Int32Array(x);case p:return new Uint32Array(x);case g:return new Float32Array(x);case v:return new Float64Array(x);default:throw new Error("Unkown type: "+w)}},stringToBuffer:b,bufferToString:w};e.default=_}.call("undefined"!=typeof window?window:self),t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0,function(){var t=this,r=this.openDatabase;if(r){var o={_driver:"webSQLStorage",_initStorage:function(t){var e=this,o={db:null};if(t)for(var i in t)o[i]="string"!=typeof t[i]?t[i].toString():t[i];var a=new Promise(function(n,i){try{o.db=r(o.name,String(o.version),o.description,o.size)}catch(r){return e.setDriver(e.LOCALSTORAGE).then(function(){return e._initStorage(t)}).then(n).catch(i)}o.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+o.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){e._dbInfo=o,n()},function(t,e){i(e)})})});return new Promise(function(t,e){t(n(3))}).then(function(t){return o.serializer=t,a})},iterate:function(t,e){var n=this,r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,a=i.length,s=0;s<a;s++){var u=i.item(s),c=u.value;if(c&&(c=o.serializer.deserialize(c)),void 0!==(c=t(c,u.key,s+1)))return void e(c)}e()},function(t,e){r(e)})})}).catch(r)});return i(r,e),r},getItem:function(e,n){var r=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)},function(t,e){n(e)})})}).catch(n)});return i(o,n),o},setItem:function(e,n,r){var o=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var a=new Promise(function(t,r){o.ready().then(function(){void 0===n&&(n=null);var i=n,a=o._dbInfo;a.serializer.serialize(n,function(n,o){o?r(o):a.db.transaction(function(o){o.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[e,n],function(){t(i)},function(t,e){r(e)})},function(t){t.code===t.QUOTA_ERR&&r(t)})})}).catch(r)});return i(a,r),a},removeItem:function(e,n){var r=this;"string"!=typeof e&&(t.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(t,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){t()},function(t,e){n(e)})})}).catch(n)});return i(o,n),o},clear:function(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return i(n,t),n},length:function(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return i(n,t),n},key:function(t,e){var n=this,r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return i(r,e),r},keys:function(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);t(r)},function(t,e){n(e)})})}).catch(n)});return i(n,t),n}};e.default=o}function i(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}}.call("undefined"!=typeof window?window:self),t.exports=e.default}])},"object"==typeof n&&"object"==typeof e?e.exports=o():"object"==typeof n?n.localforage=o():r.localforage=o()},{__browserify_process:4}],19:[function(t,e,n){(function(){var t=this,r=t._,o={},i=Array.prototype,a=Object.prototype,s=Function.prototype,u=i.push,c=i.slice,l=i.concat,f=a.toString,d=a.hasOwnProperty,h=i.forEach,p=i.map,g=i.reduce,v=i.reduceRight,y=i.filter,m=i.every,b=i.some,w=i.indexOf,_=i.lastIndexOf,x=Array.isArray,E=Object.keys,k=s.bind,S=function(t){return t instanceof S?t:this instanceof S?void(this._wrapped=t):new S(t)};void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=S),n._=S):t._=S,S.VERSION="1.4.4";var A=S.each=S.forEach=function(t,e,n){if(null!=t)if(h&&t.forEach===h)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,i=t.length;r<i;r++)if(e.call(n,t[r],r,t)===o)return}else for(var a in t)if(S.has(t,a)&&e.call(n,t[a],a,t)===o)return};S.map=S.collect=function(t,e,n){var r=[];return null==t?r:p&&t.map===p?t.map(e,n):(A(t,function(t,o,i){r[r.length]=e.call(n,t,o,i)}),r)};var I="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(t,e,n,r){var o=arguments.length>2;if(null==t&&(t=[]),g&&t.reduce===g)return r&&(e=S.bind(e,r)),o?t.reduce(e,n):t.reduce(e);if(A(t,function(t,i,a){o?n=e.call(r,n,t,i,a):(n=t,o=!0)}),!o)throw new TypeError(I);return n},S.reduceRight=S.foldr=function(t,e,n,r){var o=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return r&&(e=S.bind(e,r)),o?t.reduceRight(e,n):t.reduceRight(e);var i=t.length;if(i!==+i){var a=S.keys(t);i=a.length}if(A(t,function(s,u,c){u=a?a[--i]:--i,o?n=e.call(r,n,t[u],u,c):(n=t[u],o=!0)}),!o)throw new TypeError(I);return n},S.find=S.detect=function(t,e,n){var r;return j(t,function(t,o,i){if(e.call(n,t,o,i))return r=t,!0}),r},S.filter=S.select=function(t,e,n){var r=[];return null==t?r:y&&t.filter===y?t.filter(e,n):(A(t,function(t,o,i){e.call(n,t,o,i)&&(r[r.length]=t)}),r)},S.reject=function(t,e,n){return S.filter(t,function(t,r,o){return!e.call(n,t,r,o)},n)},S.every=S.all=function(t,e,n){e||(e=S.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,n):(A(t,function(t,i,a){if(!(r=r&&e.call(n,t,i,a)))return o}),!!r)};var j=S.some=S.any=function(t,e,n){e||(e=S.identity);var r=!1;return null==t?r:b&&t.some===b?t.some(e,n):(A(t,function(t,i,a){if(r||(r=e.call(n,t,i,a)))return o}),!!r)};S.contains=S.include=function(t,e){return null!=t&&(w&&t.indexOf===w?-1!=t.indexOf(e):j(t,function(t){return t===e}))},S.invoke=function(t,e){var n=c.call(arguments,2),r=S.isFunction(e);return S.map(t,function(t){return(r?e:t[e]).apply(t,n)})},S.pluck=function(t,e){return S.map(t,function(t){return t[e]})},S.where=function(t,e,n){return S.isEmpty(e)?n?null:[]:S[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},S.findWhere=function(t,e){return S.where(t,e,!0)},S.max=function(t,e,n){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&S.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return A(t,function(t,o,i){var a=e?e.call(n,t,o,i):t;a>=r.computed&&(r={value:t,computed:a})}),r.value},S.min=function(t,e,n){if(!e&&S.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&S.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return A(t,function(t,o,i){var a=e?e.call(n,t,o,i):t;a<r.computed&&(r={value:t,computed:a})}),r.value},S.shuffle=function(t){var e,n=0,r=[];return A(t,function(t){e=S.random(n++),r[n-1]=r[e],r[e]=t}),r};var P=function(t){return S.isFunction(t)?t:function(e){return e[t]}};S.sortBy=function(t,e,n){var r=P(e);return S.pluck(S.map(t,function(t,e,o){return{value:t,index:e,criteria:r.call(n,t,e,o)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index<e.index?-1:1}),"value")};var T=function(t,e,n,r){var o={},i=P(e||S.identity);return A(t,function(e,a){var s=i.call(n,e,a,t);r(o,s,e)}),o};S.groupBy=function(t,e,n){return T(t,e,n,function(t,e,n){(S.has(t,e)?t[e]:t[e]=[]).push(n)})},S.countBy=function(t,e,n){return T(t,e,n,function(t,e){S.has(t,e)||(t[e]=0),t[e]++})},S.sortedIndex=function(t,e,n,r){for(var o=(n=null==n?S.identity:P(n)).call(r,e),i=0,a=t.length;i<a;){var s=i+a>>>1;n.call(r,t[s])<o?i=s+1:a=s}return i},S.toArray=function(t){return t?S.isArray(t)?c.call(t):t.length===+t.length?S.map(t,S.identity):S.values(t):[]},S.size=function(t){return null==t?0:t.length===+t.length?t.length:S.keys(t).length},S.first=S.head=S.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:c.call(t,0,e)},S.initial=function(t,e,n){return c.call(t,0,t.length-(null==e||n?1:e))},S.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:c.call(t,Math.max(t.length-e,0))},S.rest=S.tail=S.drop=function(t,e,n){return c.call(t,null==e||n?1:e)},S.compact=function(t){return S.filter(t,S.identity)};var O=function(t,e,n){return A(t,function(t){S.isArray(t)?e?u.apply(n,t):O(t,e,n):n.push(t)}),n};S.flatten=function(t,e){return O(t,e,[])},S.without=function(t){return S.difference(t,c.call(arguments,1))},S.uniq=S.unique=function(t,e,n,r){S.isFunction(e)&&(r=n,n=e,e=!1);var o=n?S.map(t,n,r):t,i=[],a=[];return A(o,function(n,r){(e?r&&a[a.length-1]===n:S.contains(a,n))||(a.push(n),i.push(t[r]))}),i},S.union=function(){return S.uniq(l.apply(i,arguments))},S.intersection=function(t){var e=c.call(arguments,1);return S.filter(S.uniq(t),function(t){return S.every(e,function(e){return S.indexOf(e,t)>=0})})},S.difference=function(t){var e=l.apply(i,c.call(arguments,1));return S.filter(t,function(t){return!S.contains(e,t)})},S.zip=function(){for(var t=c.call(arguments),e=S.max(S.pluck(t,"length")),n=new Array(e),r=0;r<e;r++)n[r]=S.pluck(t,""+r);return n},S.object=function(t,e){if(null==t)return{};for(var n={},r=0,o=t.length;r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},S.indexOf=function(t,e,n){if(null==t)return-1;var r=0,o=t.length;if(n){if("number"!=typeof n)return t[r=S.sortedIndex(t,e)]===e?r:-1;r=n<0?Math.max(0,o+n):n}if(w&&t.indexOf===w)return t.indexOf(e,n);for(;r<o;r++)if(t[r]===e)return r;return-1},S.lastIndexOf=function(t,e,n){if(null==t)return-1;var r=null!=n;if(_&&t.lastIndexOf===_)return r?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var o=r?n:t.length;o--;)if(t[o]===e)return o;return-1},S.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),o=0,i=new Array(r);o<r;)i[o++]=t,t+=n;return i},S.bind=function(t,e){if(t.bind===k&&k)return k.apply(t,c.call(arguments,1));var n=c.call(arguments,2);return function(){return t.apply(e,n.concat(c.call(arguments)))}},S.partial=function(t){var e=c.call(arguments,1);return function(){return t.apply(this,e.concat(c.call(arguments)))}},S.bindAll=function(t){var e=c.call(arguments,1);return 0===e.length&&(e=S.functions(t)),A(e,function(e){t[e]=S.bind(t[e],t)}),t},S.memoize=function(t,e){var n={};return e||(e=S.identity),function(){var r=e.apply(this,arguments);return S.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},S.delay=function(t,e){var n=c.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},S.defer=function(t){return S.delay.apply(S,[t,1].concat(c.call(arguments,1)))},S.throttle=function(t,e){var n,r,o,i,a=0,s=function(){a=new Date,o=null,i=t.apply(n,r)};return function(){var u=new Date,c=e-(u-a);return n=this,r=arguments,c<=0?(clearTimeout(o),o=null,a=u,i=t.apply(n,r)):o||(o=setTimeout(s,c)),i}},S.debounce=function(t,e,n){var r,o;return function(){var i=this,a=arguments,s=n&&!r;return clearTimeout(r),r=setTimeout(function(){r=null,n||(o=t.apply(i,a))},e),s&&(o=t.apply(i,a)),o}},S.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},S.wrap=function(t,e){return function(){var n=[t];return u.apply(n,arguments),e.apply(this,n)}},S.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},S.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},S.keys=E||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)S.has(t,n)&&(e[e.length]=n);return e},S.values=function(t){var e=[];for(var n in t)S.has(t,n)&&e.push(t[n]);return e},S.pairs=function(t){var e=[];for(var n in t)S.has(t,n)&&e.push([n,t[n]]);return e},S.invert=function(t){var e={};for(var n in t)S.has(t,n)&&(e[t[n]]=n);return e},S.functions=S.methods=function(t){var e=[];for(var n in t)S.isFunction(t[n])&&e.push(n);return e.sort()},S.extend=function(t){return A(c.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},S.pick=function(t){var e={},n=l.apply(i,c.call(arguments,1));return A(n,function(n){n in t&&(e[n]=t[n])}),e},S.omit=function(t){var e={},n=l.apply(i,c.call(arguments,1));for(var r in t)S.contains(n,r)||(e[r]=t[r]);return e},S.defaults=function(t){return A(c.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},S.clone=function(t){return S.isObject(t)?S.isArray(t)?t.slice():S.extend({},t):t},S.tap=function(t,e){return e(t),t};var M=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof S&&(t=t._wrapped),e instanceof S&&(e=e._wrapped);var o=f.call(t);if(o!=f.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var i=n.length;i--;)if(n[i]==t)return r[i]==e;n.push(t),r.push(e);var a=0,s=!0;if("[object Array]"==o){if(s=(a=t.length)==e.length)for(;a--&&(s=M(t[a],e[a],n,r)););}else{var u=t.constructor,c=e.constructor;if(u!==c&&!(S.isFunction(u)&&u instanceof u&&S.isFunction(c)&&c instanceof c))return!1;for(var l in t)if(S.has(t,l)&&(a++,!(s=S.has(e,l)&&M(t[l],e[l],n,r))))break;if(s){for(l in e)if(S.has(e,l)&&!a--)break;s=!a}}return n.pop(),r.pop(),s};S.isEqual=function(t,e){return M(t,e,[],[])},S.isEmpty=function(t){if(null==t)return!0;if(S.isArray(t)||S.isString(t))return 0===t.length;for(var e in t)if(S.has(t,e))return!1;return!0},S.isElement=function(t){return!(!t||1!==t.nodeType)},S.isArray=x||function(t){return"[object Array]"==f.call(t)},S.isObject=function(t){return t===Object(t)},A(["Arguments","Function","String","Number","Date","RegExp"],function(t){S["is"+t]=function(e){return f.call(e)=="[object "+t+"]"}}),S.isArguments(arguments)||(S.isArguments=function(t){return!(!t||!S.has(t,"callee"))}),S.isFunction=function(t){return"function"==typeof t},S.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},S.isNaN=function(t){return S.isNumber(t)&&t!=+t},S.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==f.call(t)},S.isNull=function(t){return null===t},S.isUndefined=function(t){return void 0===t},S.has=function(t,e){return d.call(t,e)},S.noConflict=function(){return t._=r,this},S.identity=function(t){return t},S.times=function(t,e,n){for(var r=Array(t),o=0;o<t;o++)r[o]=e.call(n,o);return r},S.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};D.unescape=S.invert(D.escape);var L={escape:new RegExp("["+S.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(D.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(t){S[t]=function(e){return null==e?"":(""+e).replace(L[t],function(e){return D[t][e]})}}),S.result=function(t,e){if(null==t)return null;var n=t[e];return S.isFunction(n)?n.call(t):n},S.mixin=function(t){A(S.functions(t),function(e){var n=S[e]=t[e];S.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),R.call(this,n.apply(S,t))}})};var C=0;S.uniqueId=function(t){var e=++C+"";return t?t+e:e},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(t,e,n){var r;n=S.defaults({},n,S.templateSettings);var o=new RegExp([(n.escape||B).source,(n.interpolate||B).source,(n.evaluate||B).source].join("|")+"|$","g"),i=0,a="__p+='";t.replace(o,function(e,n,r,o,s){return a+=t.slice(i,s).replace($,function(t){return"\\"+N[t]}),n&&(a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(a+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),o&&(a+="';\n"+o+"\n__p+='"),i=s+e.length,e}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(n.variable||"obj","_",a)}catch(t){throw t.source=a,t}if(e)return r(e,S);var s=function(t){return r.call(this,t,S)};return s.source="function("+(n.variable||"obj")+"){\n"+a+"}",s},S.chain=function(t){return S(t).chain()};var R=function(t){return this._chain?S(t).chain():t};S.mixin(S),A(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];S.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],R.call(this,n)}}),A(["concat","join","slice"],function(t){var e=i[t];S.prototype[t]=function(){return R.call(this,e.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}]},{},[7])(7)},"function"==typeof bootstrap?bootstrap("nedb",r):t.exports=r()}).call(this,n(46).setImmediate)},function(t,e,n){"use strict";var r=l(n(9)),o=(n(3),n(43)),i=n(7),a=l(n(26)),s=l(n(15)),u=l(n(12)),c=n(10);function l(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}r.isReady().then(function(t){r.getSettings().then(function(t){t?d(t):r.updateSettings(c.defaultSettings).then(function(t){console.log("successfully, loaded settings, now calling setup()"),d(c.defaultSettings)},function(t){console.log("failed to loaded settings to db")})},function(t){return console.log("error in checkSettings of app.js")})},function(t){console.log(t),console.log("\tonFailure callback of db.isReady() in app.js")});var f=void 0;function d(t){!function(t){document.documentElement.style.setProperty("--color-1","hsl("+t.color0+", 50%, 50%)"),document.documentElement.style.setProperty("--color-1-dark","hsl("+t.color0+", 65%, 35%)"),document.documentElement.style.setProperty("--color-2","hsl("+t.color1+", 50%, 50%)"),document.documentElement.style.setProperty("--color-2-dark","hsl("+t.color1+", 65%, 35%)"),document.documentElement.style.setProperty("--color-3","hsl("+t.color2+", 50%, 50%)"),document.documentElement.style.setProperty("--color-3-dark","hsl("+t.color2+", 65%, 35%)")}(t),f=new o.Navigator([s,a,u],"main-container"),document.getElementById("nav-container").innerHTML=f.render(),f.postRender(),(0,i.insertSpacers)("#nav-container"),a.init(r,f,t),s.init(r,t),f.navigateTo(s.id)}}]);